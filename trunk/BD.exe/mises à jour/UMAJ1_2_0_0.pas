unit UMAJ1_2_0_0;

interface

implementation

uses JvUIB, Updates;

procedure InitialiseTables(Query: TJvUIBScript);
begin
  with Query do begin
    Script.Clear;
    Script.Add('ALTER TRIGGER ALBUMS_AI INACTIVE;');
    Script.Add('ALTER TRIGGER ALBUMS_DV INACTIVE;');
    Script.Add('ALTER TRIGGER ALBUMS_UNIQID_BIU0 INACTIVE;');
    Script.Add('ALTER TRIGGER AUTEURS_PARABD_UNIQID_BIU0 INACTIVE;');
    Script.Add('ALTER TRIGGER AUTEURS_SERIES_UNIQID_BIU0 INACTIVE;');
    Script.Add('ALTER TRIGGER AUTEURS_UNIQID_BIU0 INACTIVE;');
    Script.Add('ALTER TRIGGER COLLECTIONS_AI INACTIVE;');
    Script.Add('ALTER TRIGGER COLLECTIONS_DV INACTIVE;');
    Script.Add('ALTER TRIGGER COLLECTIONS_EDITIONS_REF INACTIVE;');
    Script.Add('ALTER TRIGGER COLLECTIONS_SERIE_REF INACTIVE;');
    Script.Add('ALTER TRIGGER COLLECTIONS_UNIQID_BIU0 INACTIVE;');
    Script.Add('ALTER TRIGGER CONVERSIONS_UNIQID_BIU0 INACTIVE;');
    Script.Add('ALTER TRIGGER COTES_PARABD_UNIQID_BIU0 INACTIVE;');
    Script.Add('ALTER TRIGGER COTES_UNIQID_BIU0 INACTIVE;');
    Script.Add('ALTER TRIGGER COUVERTURES_AI INACTIVE;');
    Script.Add('ALTER TRIGGER COUVERTURES_UNIQID_BIU0 INACTIVE;');
    Script.Add('ALTER TRIGGER CRITEREBOOLEAN_UNIQID_BIU0 INACTIVE;');
    Script.Add('ALTER TRIGGER CRITEREIMAGE_UNIQID_BIU0 INACTIVE;');
    Script.Add('ALTER TRIGGER CRITERELANGUETITRE_UNIQID_BIU0 INACTIVE;');
    Script.Add('ALTER TRIGGER CRITERELISTE_UNIQID_BIU0 INACTIVE;');
    Script.Add('ALTER TRIGGER CRITERENUMERAL_UNIQID_BIU0 INACTIVE;');
    Script.Add('ALTER TRIGGER CRITERESTRING_UNIQID_BIU0 INACTIVE;');
    Script.Add('ALTER TRIGGER CRITERETITRE_UNIQID_BIU0 INACTIVE;');
    Script.Add('ALTER TRIGGER EDITEURS_AI INACTIVE;');
    Script.Add('ALTER TRIGGER EDITEURS_DV INACTIVE;');
    Script.Add('ALTER TRIGGER EDITEURS_SERIE_REF INACTIVE;');
    Script.Add('ALTER TRIGGER EDITEURS_UNIQID_BIU0 INACTIVE;');
    Script.Add('ALTER TRIGGER EDITIONS_AD0 INACTIVE;');
    Script.Add('ALTER TRIGGER EDITIONS_AI INACTIVE;');
    Script.Add('ALTER TRIGGER EDITIONS_AI0 INACTIVE;');
    Script.Add('ALTER TRIGGER EDITIONS_AU0 INACTIVE;');
    Script.Add('ALTER TRIGGER EDITIONS_BU0 INACTIVE;');
    Script.Add('ALTER TRIGGER EDITIONS_COTE_BIU1 INACTIVE;');
    Script.Add('ALTER TRIGGER EDITIONS_UNIQID_BIU0 INACTIVE;');
    Script.Add('ALTER TRIGGER EMPRUNTEURS_AI INACTIVE;');
    Script.Add('ALTER TRIGGER EMPRUNTEURS_DV INACTIVE;');
    Script.Add('ALTER TRIGGER EMPRUNTEURS_UNIQID_BIU0 INACTIVE;');
    Script.Add('ALTER TRIGGER ENTRETIENT_UNIQID_BIU0 INACTIVE;');
    Script.Add('ALTER TRIGGER GENRESERIES_UNIQID_BIU0 INACTIVE;');
    Script.Add('ALTER TRIGGER GENRES_AI INACTIVE;');
    Script.Add('ALTER TRIGGER GENRES_DV INACTIVE;');
    Script.Add('ALTER TRIGGER GENRES_UNIQID_BIU0 INACTIVE;');
    Script.Add('ALTER TRIGGER LISTES_AUD0 INACTIVE;');
    Script.Add('ALTER TRIGGER LISTES_UNIQID_BIU0 INACTIVE;');
    Script.Add('ALTER TRIGGER OPTIONS_UNIQID_BIU0 INACTIVE;');
    Script.Add('ALTER TRIGGER PARABD_AI INACTIVE;');
    Script.Add('ALTER TRIGGER PARABD_COTE_BIU1 INACTIVE;');
    Script.Add('ALTER TRIGGER PARABD_DV INACTIVE;');
    Script.Add('ALTER TRIGGER PARABD_UNIQID_BIU0 INACTIVE;');
    Script.Add('ALTER TRIGGER PERSONNES_AI INACTIVE;');
    Script.Add('ALTER TRIGGER PERSONNES_DV INACTIVE;');
    Script.Add('ALTER TRIGGER PERSONNES_UNIQID_BIU0 INACTIVE;');
    Script.Add('ALTER TRIGGER SERIES_AI INACTIVE;');
    Script.Add('ALTER TRIGGER SERIES_DV INACTIVE;');
    Script.Add('ALTER TRIGGER SERIES_UNIQID_BIU0 INACTIVE;');
    Script.Add('ALTER TRIGGER STATUT_AI INACTIVE;');
    Script.Add('ALTER TRIGGER STATUT_UNIQID_BIU0 INACTIVE;');

    Script.Add('ALTER TABLE ALBUMS');
    Script.Add('    ADD ID_SERIE T_GUID_NOTNULL;');
    Script.Add('alter table ALBUMS alter ID_ALBUMS position 1;');
    Script.Add('alter table ALBUMS alter REFALBUM position 2;');
    Script.Add('alter table ALBUMS alter TITREALBUM position 3;');
    Script.Add('alter table ALBUMS alter MOISPARUTION position 4;');
    Script.Add('alter table ALBUMS alter ANNEEPARUTION position 5;');
    Script.Add('alter table ALBUMS alter REFSERIE position 6;');
    Script.Add('alter table ALBUMS alter ID_SERIE position 7;');
    Script.Add('alter table ALBUMS alter TOME position 8;');
    Script.Add('alter table ALBUMS alter TOMEDEBUT position 9;');
    Script.Add('alter table ALBUMS alter TOMEFIN position 10;');
    Script.Add('alter table ALBUMS alter HORSSERIE position 11;');
    Script.Add('alter table ALBUMS alter INTEGRALE position 12;');
    Script.Add('alter table ALBUMS alter SUJETALBUM position 13;');
    Script.Add('alter table ALBUMS alter REMARQUESALBUM position 14;');
    Script.Add('alter table ALBUMS alter TITREINITIALESALBUM position 15;');
    Script.Add('alter table ALBUMS alter UPPERTITREALBUM position 16;');
    Script.Add('alter table ALBUMS alter UPPERSUJETALBUM position 17;');
    Script.Add('alter table ALBUMS alter UPPERREMARQUESALBUM position 18;');
    Script.Add('alter table ALBUMS alter SOUNDEXTITREALBUM position 19;');
    Script.Add('alter table ALBUMS alter INITIALETITREALBUM position 20;');
    Script.Add('alter table ALBUMS alter ACHAT position 21;');
    Script.Add('alter table ALBUMS alter NBEDITIONS position 22;');
    Script.Add('alter table ALBUMS alter COMPLET position 23;');
    Script.Add('alter table ALBUMS alter DC_ALBUMS position 24;');
    Script.Add('alter table ALBUMS alter DM_ALBUMS position 25;');

    Script.Add('update albums a set');
    Script.Add('  id_serie = (select id_series from series s where a.refserie = s.refserie);');

    Script.Add('ALTER TABLE AUTEURS');
    Script.Add('    ADD ID_ALBUM T_GUID_NOTNULL,');
    Script.Add('    ADD ID_PERSONNE T_GUID_NOTNULL;');
    Script.Add('alter table AUTEURS alter ID_AUTEURS position 1;');
    Script.Add('alter table AUTEURS alter REFALBUM position 2;');
    Script.Add('alter table AUTEURS alter ID_ALBUM position 3;');
    Script.Add('alter table AUTEURS alter REFPERSONNE position 4;');
    Script.Add('alter table AUTEURS alter ID_PERSONNE position 5;');
    Script.Add('alter table AUTEURS alter METIER position 6;');
    Script.Add('alter table AUTEURS alter DC_AUTEURS position 7;');
    Script.Add('alter table AUTEURS alter DM_AUTEURS position 8;');

    Script.Add('update auteurs au set');
    Script.Add('  id_album = (select id_albums from albums al where au.refalbum = al.refalbum),');
    Script.Add('  id_personne = (select id_personnes from personnes p where au.refpersonne = p.refpersonne);');

    Script.Add('ALTER TABLE AUTEURS_PARABD');
    Script.Add('    ADD ID_PARABD T_GUID_NOTNULL,');
    Script.Add('    ADD ID_PERSONNE T_GUID_NOTNULL;');
    Script.Add('alter table AUTEURS_PARABD alter ID_AUTEURS_PARABD position 1;');
    Script.Add('alter table AUTEURS_PARABD alter REFPARABD position 2;');
    Script.Add('alter table AUTEURS_PARABD alter ID_PARABD position 3;');
    Script.Add('alter table AUTEURS_PARABD alter REFPERSONNE position 4;');
    Script.Add('alter table AUTEURS_PARABD alter ID_PERSONNE position 5;');
    Script.Add('alter table AUTEURS_PARABD alter DC_AUTEURS_PARABD position 6;');
    Script.Add('alter table AUTEURS_PARABD alter DM_AUTEURS_PARABD position 7;');

    Script.Add('update auteurs_parabd a set');
    Script.Add('  id_parabd = (select id_parabd from parabd p where a.refparabd = p.refparabd),');
    Script.Add('  id_personne = (select id_personnes from personnes p where a.refpersonne = p.refpersonne);');

    Script.Add('ALTER TABLE AUTEURS_SERIES');
    Script.Add('    ADD ID_SERIE T_GUID_NOTNULL,');
    Script.Add('    ADD ID_PERSONNE T_GUID_NOTNULL;');
    Script.Add('alter table AUTEURS_SERIES alter ID_AUTEURS_SERIES position 1;');
    Script.Add('alter table AUTEURS_SERIES alter REFSERIE position 2;');
    Script.Add('alter table AUTEURS_SERIES alter ID_SERIE position 3;');
    Script.Add('alter table AUTEURS_SERIES alter REFPERSONNE position 4;');
    Script.Add('alter table AUTEURS_SERIES alter ID_PERSONNE position 5;');
    Script.Add('alter table AUTEURS_SERIES alter METIER position 6;');
    Script.Add('alter table AUTEURS_SERIES alter DC_AUTEURS_SERIES position 7;');
    Script.Add('alter table AUTEURS_SERIES alter DM_AUTEURS_SERIES position 8;');

    Script.Add('update auteurs_series a set');
    Script.Add('  id_serie = (select id_series from series s where a.refserie = s.refserie),');
    Script.Add('  id_personne = (select id_personnes from personnes p where a.refpersonne = p.refpersonne);');

    Script.Add('ALTER TABLE COLLECTIONS');
    Script.Add('    ADD ID_EDITEUR T_GUID_NOTNULL;');
    Script.Add('alter table COLLECTIONS alter ID_COLLECTIONS position 1;');
    Script.Add('alter table COLLECTIONS alter REFCOLLECTION position 2;');
    Script.Add('alter table COLLECTIONS alter NOMCOLLECTION position 3;');
    Script.Add('alter table COLLECTIONS alter REFEDITEUR position 4;');
    Script.Add('alter table COLLECTIONS alter ID_EDITEUR position 5;');
    Script.Add('alter table COLLECTIONS alter UPPERNOMCOLLECTION position 6;');
    Script.Add('alter table COLLECTIONS alter INITIALENOMCOLLECTION position 7;');
    Script.Add('alter table COLLECTIONS alter DC_COLLECTIONS position 8;');
    Script.Add('alter table COLLECTIONS alter DM_COLLECTIONS position 9;');

    Script.Add('update collections c set');
    Script.Add('  id_editeur = (select id_editeurs from editeurs e where c.refediteur = e.refediteur);');

    Script.Add('ALTER TABLE COTES');
    Script.Add('    ADD ID_EDITION T_GUID_NOTNULL;');
    Script.Add('alter table COTES alter ID_COTES position 1;');
    Script.Add('alter table COTES alter REFEDITION position 2;');
    Script.Add('alter table COTES alter ID_EDITION position 3;');
    Script.Add('alter table COTES alter ANNEECOTE position 4;');
    Script.Add('alter table COTES alter PRIXCOTE position 5;');
    Script.Add('alter table COTES alter DC_COTES position 6;');
    Script.Add('alter table COTES alter DM_COTES position 7;');

    Script.Add('update cotes c set');
    Script.Add('  id_edition = (select id_editions from editions e where c.refedition = e.refedition);');

    Script.Add('ALTER TABLE COTES_PARABD');
    Script.Add('    ADD ID_PARABD T_GUID_NOTNULL;');
    Script.Add('alter table COTES_PARABD alter ID_COTES_PARABD position 1;');
    Script.Add('alter table COTES_PARABD alter REFPARABD position 2;');
    Script.Add('alter table COTES_PARABD alter ID_PARABD position 3;');
    Script.Add('alter table COTES_PARABD alter ANNEECOTE position 4;');
    Script.Add('alter table COTES_PARABD alter PRIXCOTE position 5;');
    Script.Add('alter table COTES_PARABD alter DC_COTES_PARABD position 6;');
    Script.Add('alter table COTES_PARABD alter DM_COTES_PARABD position 7;');

    Script.Add('update cotes_parabd c set');
    Script.Add('  id_parabd = (select id_parabd from parabd p where c.refparabd = p.refparabd);');

    Script.Add('ALTER TABLE COUVERTURES');
    Script.Add('    ADD ID_ALBUM T_GUID,');
    Script.Add('    ADD ID_EDITION T_GUID;');
    Script.Add('alter table COUVERTURES alter ID_COUVERTURES position 1;');
    Script.Add('alter table COUVERTURES alter REFCOUVERTURE position 2;');
    Script.Add('alter table COUVERTURES alter REFALBUM position 3;');
    Script.Add('alter table COUVERTURES alter ID_ALBUM position 4;');
    Script.Add('alter table COUVERTURES alter REFEDITION position 5;');
    Script.Add('alter table COUVERTURES alter ID_EDITION position 6;');
    Script.Add('alter table COUVERTURES alter ORDRE position 7;');
    Script.Add('alter table COUVERTURES alter CATEGORIEIMAGE position 8;');
    Script.Add('alter table COUVERTURES alter STOCKAGECOUVERTURE position 9;');
    Script.Add('alter table COUVERTURES alter IMAGECOUVERTURE position 10;');
    Script.Add('alter table COUVERTURES alter FICHIERCOUVERTURE position 11;');
    Script.Add('alter table COUVERTURES alter DC_COUVERTURES position 12;');
    Script.Add('alter table COUVERTURES alter DM_COUVERTURES position 13;');

    Script.Add('update couvertures c set');
    Script.Add('  id_album = (select id_albums from albums a where c.refalbum = a.refalbum),');
    Script.Add('  id_edition = (select id_editions from editions e where c.refedition = e.refedition);');

    Script.Add('ALTER TABLE EDITIONS');
    Script.Add('    ADD ID_ALBUM T_GUID_NOTNULL,');
    Script.Add('    ADD ID_EDITEUR T_GUID_NOTNULL,');
    Script.Add('    ADD ID_COLLECTION T_GUID;');
    Script.Add('alter table EDITIONS alter ID_EDITIONS position 1;');
    Script.Add('alter table EDITIONS alter REFEDITION position 2;');
    Script.Add('alter table EDITIONS alter REFALBUM position 3;');
    Script.Add('alter table EDITIONS alter ID_ALBUM position 4;');
    Script.Add('alter table EDITIONS alter REFEDITEUR position 5;');
    Script.Add('alter table EDITIONS alter ID_EDITEUR position 6;');
    Script.Add('alter table EDITIONS alter REFCOLLECTION position 7;');
    Script.Add('alter table EDITIONS alter ID_COLLECTION position 8;');
    Script.Add('alter table EDITIONS alter ANNEEEDITION position 9;');
    Script.Add('alter table EDITIONS alter PRIX position 10;');
    Script.Add('alter table EDITIONS alter VO position 11;');
    Script.Add('alter table EDITIONS alter COULEUR position 12;');
    Script.Add('alter table EDITIONS alter ISBN position 13;');
    Script.Add('alter table EDITIONS alter PRETE position 14;');
    Script.Add('alter table EDITIONS alter STOCK position 15;');
    Script.Add('alter table EDITIONS alter DEDICACE position 16;');
    Script.Add('alter table EDITIONS alter ETAT position 17;');
    Script.Add('alter table EDITIONS alter RELIURE position 18;');
    Script.Add('alter table EDITIONS alter TYPEEDITION position 19;');
    Script.Add('alter table EDITIONS alter NOTES position 20;');
    Script.Add('alter table EDITIONS alter DATEACHAT position 21;');
    Script.Add('alter table EDITIONS alter GRATUIT position 22;');
    Script.Add('alter table EDITIONS alter OFFERT position 23;');
    Script.Add('alter table EDITIONS alter NOMBREDEPAGES position 24;');
    Script.Add('alter table EDITIONS alter ORIENTATION position 25;');
    Script.Add('alter table EDITIONS alter FORMATEDITION position 26;');
    Script.Add('alter table EDITIONS alter ANNEECOTE position 27;');
    Script.Add('alter table EDITIONS alter PRIXCOTE position 28;');
    Script.Add('alter table EDITIONS alter DC_EDITIONS position 29;');
    Script.Add('alter table EDITIONS alter DM_EDITIONS position 30;');

    Script.Add('update editions e set');
    Script.Add('  id_album = (select id_albums from albums a where e.refalbum = a.refalbum),');
    Script.Add('  id_editeur = (select id_editeurs from editeurs ed where e.refediteur = ed.refediteur),');
    Script.Add('  id_collection = (select id_collections from collections c where e.refcollection = c.refcollection);');

    Script.Add('ALTER TABLE GENRESERIES');
    Script.Add('    ADD ID_SERIE T_GUID_NOTNULL,');
    Script.Add('    ADD ID_GENRE T_GUID_NOTNULL;');
    Script.Add('alter table GENRESERIES alter ID_GENRESERIES position 1;');
    Script.Add('alter table GENRESERIES alter REFSERIE position 2;');
    Script.Add('alter table GENRESERIES alter ID_SERIE position 3;');
    Script.Add('alter table GENRESERIES alter REFGENRE position 4;');
    Script.Add('alter table GENRESERIES alter ID_GENRE position 5;');
    Script.Add('alter table GENRESERIES alter DC_GENRESERIES position 6;');
    Script.Add('alter table GENRESERIES alter DM_GENRESERIES position 7;');

    Script.Add('update genreseries gs set');
    Script.Add('  id_serie = (select id_series from series s where s.refserie = gs.refserie),');
    Script.Add('  id_genre = (select id_genres from genres g where g.refgenre = gs.refgenre);');

    Script.Add('ALTER TABLE PARABD');
    Script.Add('    ADD ID_SERIE T_GUID_NOTNULL;');
    Script.Add('alter table PARABD alter ID_PARABD position 1;');
    Script.Add('alter table PARABD alter REFPARABD position 2;');
    Script.Add('alter table PARABD alter TITREPARABD position 3;');
    Script.Add('alter table PARABD alter REFSERIE position 4;');
    Script.Add('alter table PARABD alter ID_SERIE position 5;');
    Script.Add('alter table PARABD alter CATEGORIEPARABD position 6;');
    Script.Add('alter table PARABD alter ACHAT position 7;');
    Script.Add('alter table PARABD alter COMPLET position 8;');
    Script.Add('alter table PARABD alter DEDICACE position 9;');
    Script.Add('alter table PARABD alter NUMEROTE position 10;');
    Script.Add('alter table PARABD alter ANNEE position 11;');
    Script.Add('alter table PARABD alter ANNEECOTE position 12;');
    Script.Add('alter table PARABD alter PRIXCOTE position 13;');
    Script.Add('alter table PARABD alter PRETE position 14;');
    Script.Add('alter table PARABD alter STOCK position 15;');
    Script.Add('alter table PARABD alter DATEACHAT position 16;');
    Script.Add('alter table PARABD alter PRIX position 17;');
    Script.Add('alter table PARABD alter GRATUIT position 18;');
    Script.Add('alter table PARABD alter OFFERT position 19;');
    Script.Add('alter table PARABD alter STOCKAGEPARABD position 20;');
    Script.Add('alter table PARABD alter IMAGEPARABD position 21;');
    Script.Add('alter table PARABD alter FICHIERPARABD position 22;');
    Script.Add('alter table PARABD alter TITREINITIALESPARABD position 23;');
    Script.Add('alter table PARABD alter UPPERTITREPARABD position 24;');
    Script.Add('alter table PARABD alter SOUNDEXTITREPARABD position 25;');
    Script.Add('alter table PARABD alter INITIALETITREPARABD position 26;');
    Script.Add('alter table PARABD alter DESCRIPTION position 27;');
    Script.Add('alter table PARABD alter UPPERDESCRIPTION position 28;');
    Script.Add('alter table PARABD alter DC_PARABD position 29;');
    Script.Add('alter table PARABD alter DM_PARABD position 30;');

    Script.Add('update parabd p set');
    Script.Add('  id_serie = (select id_series from series s where s.refserie = p.refserie);');

    Script.Add('ALTER TABLE SERIES');
    Script.Add('    ADD ID_EDITEUR T_GUID,');
    Script.Add('    ADD ID_COLLECTION T_GUID;');
    Script.Add('alter table SERIES alter ID_SERIES position 1;');
    Script.Add('alter table SERIES alter REFSERIE position 2;');
    Script.Add('alter table SERIES alter TITRESERIE position 3;');
    Script.Add('alter table SERIES alter UPPERTITRESERIE position 4;');
    Script.Add('alter table SERIES alter INITIALETITRESERIE position 5;');
    Script.Add('alter table SERIES alter REFEDITEUR position 6;');
    Script.Add('alter table SERIES alter ID_EDITEUR position 7;');
    Script.Add('alter table SERIES alter REFCOLLECTION position 8;');
    Script.Add('alter table SERIES alter ID_COLLECTION position 9;');
    Script.Add('alter table SERIES alter SUJETSERIE position 10;');
    Script.Add('alter table SERIES alter REMARQUESSERIE position 11;');
    Script.Add('alter table SERIES alter UPPERSUJETSERIE position 12;');
    Script.Add('alter table SERIES alter UPPERREMARQUESSERIE position 13;');
    Script.Add('alter table SERIES alter TERMINEE position 14;');
    Script.Add('alter table SERIES alter COMPLETE position 15;');
    Script.Add('alter table SERIES alter SOUNDEXTITRESERIE position 16;');
    Script.Add('alter table SERIES alter SITEWEB position 17;');
    Script.Add('alter table SERIES alter DC_SERIES position 18;');
    Script.Add('alter table SERIES alter DM_SERIES position 19;');

    Script.Add('update series s set');
    Script.Add('  id_editeur = (select id_editeurs from editeurs e where s.refediteur = e.refediteur),');
    Script.Add('  id_collection = (select id_collections from collections c where s.refcollection = c.refcollection);');

    Script.Add('ALTER TABLE STATUT');
    Script.Add('    ADD ID_EDITION T_GUID_NOTNULL,');
    Script.Add('    ADD ID_EMPRUNTEUR T_GUID_NOTNULL;');
    Script.Add('alter table STATUT alter ID_STATUT position 1;');
    Script.Add('alter table STATUT alter REFEMPRUNT position 2;');
    Script.Add('alter table STATUT alter DATEEMPRUNT position 3;');
    Script.Add('alter table STATUT alter REFEDITION position 4;');
    Script.Add('alter table STATUT alter ID_EDITION position 5;');
    Script.Add('alter table STATUT alter PRETEMPRUNT position 6;');
    Script.Add('alter table STATUT alter REFEMPRUNTEUR position 7;');
    Script.Add('alter table STATUT alter ID_EMPRUNTEUR position 8;');
    Script.Add('alter table STATUT alter DC_STATUT position 9;');
    Script.Add('alter table STATUT alter DM_STATUT position 10;');

    Script.Add('update statut s set');
    Script.Add('  id_edition = (select id_editions from editions e where s.refedition = e.refedition),');
    Script.Add('  id_emprunteur = (select id_emprunteurs from emprunteurs em where s.refemprunteur = em.refemprunteur);');

    Script.Add('ALTER TABLE ALBUMS DROP CONSTRAINT ALBUMS_FK1;');
    Script.Add('ALTER TABLE AUTEURS DROP CONSTRAINT AUTEURS_FK1;');
    Script.Add('ALTER TABLE AUTEURS DROP CONSTRAINT AUTEURS_FK2;');
    Script.Add('ALTER TABLE AUTEURS_PARABD DROP CONSTRAINT AUTEURS_PARABD_FK1;');
    Script.Add('ALTER TABLE AUTEURS_PARABD DROP CONSTRAINT AUTEURS_PARABD_FK2;');
    Script.Add('ALTER TABLE AUTEURS_SERIES DROP CONSTRAINT AUTEURS_SERIES_FK1;');
    Script.Add('ALTER TABLE AUTEURS_SERIES DROP CONSTRAINT AUTEURS_SERIES_FK2;');
    Script.Add('ALTER TABLE COLLECTIONS DROP CONSTRAINT COLLECTIONS_FK1;');
    Script.Add('ALTER TABLE COTES DROP CONSTRAINT COTES_FK1;');
    Script.Add('ALTER TABLE COTES_PARABD DROP CONSTRAINT COTES_PARABD_FK1;');
    Script.Add('ALTER TABLE COUVERTURES DROP CONSTRAINT COUVERTURES_FK1;');
    Script.Add('ALTER TABLE EDITIONS DROP CONSTRAINT EDITIONS_FK1;');
    Script.Add('ALTER TABLE EDITIONS DROP CONSTRAINT EDITIONS_FK2;');
    Script.Add('ALTER TABLE GENRESERIES DROP CONSTRAINT GENRESERIES_FK1;');
    Script.Add('ALTER TABLE GENRESERIES DROP CONSTRAINT GENRESERIES_FK2;');
    Script.Add('ALTER TABLE PARABD DROP CONSTRAINT PARABD_FK1;');
    Script.Add('ALTER TABLE STATUT DROP CONSTRAINT STATUT_FK1;');
    Script.Add('ALTER TABLE STATUT DROP CONSTRAINT STATUT_FK2;');

    Script.Add('ALTER TABLE ALBUMS DROP CONSTRAINT ALBUMS_PK;');
    Script.Add('ALTER TABLE AUTEURS DROP CONSTRAINT AUTEURS_PK;');
    Script.Add('ALTER TABLE AUTEURS_PARABD DROP CONSTRAINT AUTEURS_PARABD_PK;');
    Script.Add('ALTER TABLE AUTEURS_SERIES DROP CONSTRAINT AUTEURS_SERIES_PK;');
    Script.Add('ALTER TABLE COLLECTIONS DROP CONSTRAINT COLLECTIONS_PK;');
    Script.Add('ALTER TABLE COTES DROP CONSTRAINT COTES_PK;');
    Script.Add('ALTER TABLE COTES_PARABD DROP CONSTRAINT COTES_PARABD_PK;');
    Script.Add('ALTER TABLE COUVERTURES DROP CONSTRAINT COUVERTURES_PK;');
    Script.Add('ALTER TABLE EDITEURS DROP CONSTRAINT EDITEURS_PK;');
    Script.Add('ALTER TABLE EDITIONS DROP CONSTRAINT EDITIONS_PK;');
    Script.Add('ALTER TABLE EMPRUNTEURS DROP CONSTRAINT EMPRUNTEURS_PK;');
    Script.Add('ALTER TABLE ENTRETIENT DROP CONSTRAINT ENTRETIENT_PK;');
    Script.Add('ALTER TABLE GENRES DROP CONSTRAINT GENRES_PK;');
    Script.Add('ALTER TABLE PARABD DROP CONSTRAINT PARABD_PK;');
    Script.Add('ALTER TABLE PERSONNES DROP CONSTRAINT PERSONNES_PK;');
    Script.Add('ALTER TABLE SERIES DROP CONSTRAINT SERIES_PK;');
    Script.Add('ALTER TABLE STATUT DROP CONSTRAINT STATUT_PK;');

    Script.Add('ALTER TABLE ALBUMS DROP CONSTRAINT ALBUMS_UNQID;');
    Script.Add('ALTER TABLE COLLECTIONS DROP CONSTRAINT COLLECTIONS_UNQID;');
    Script.Add('ALTER TABLE COUVERTURES DROP CONSTRAINT COUVERTURES_UNQID;');
    Script.Add('ALTER TABLE EDITEURS DROP CONSTRAINT EDITEURS_UNQID;');
    Script.Add('ALTER TABLE EDITIONS DROP CONSTRAINT EDITIONS_UNQID;');
    Script.Add('ALTER TABLE EMPRUNTEURS DROP CONSTRAINT EMPRUNTEURS_UNQID;');
    Script.Add('ALTER TABLE ENTRETIENT DROP CONSTRAINT ENTRETIENT_UNQID;');
    Script.Add('ALTER TABLE GENRES DROP CONSTRAINT GENRES_UNQID;');
    Script.Add('ALTER TABLE PARABD DROP CONSTRAINT PARABD_UNQID;');
    Script.Add('ALTER TABLE PERSONNES DROP CONSTRAINT PERSONNES_UNQID;');
    Script.Add('ALTER TABLE SERIES DROP CONSTRAINT SERIES_UNQID;');
    Script.Add('ALTER TABLE STATUT DROP CONSTRAINT STATUT_UNQID;');

    Script.Add('ALTER TABLE AUTEURS DROP CONSTRAINT AUTEURS_UNQID;');
    Script.Add('ALTER TABLE AUTEURS_PARABD DROP CONSTRAINT AUTEURS_PARABD_UNQID;');
    Script.Add('ALTER TABLE AUTEURS_SERIES DROP CONSTRAINT AUTEURS_SERIES_UNQID;');
    Script.Add('ALTER TABLE CONVERSIONS DROP CONSTRAINT CONVERSIONS_UNQID;');
    Script.Add('ALTER TABLE COTES DROP CONSTRAINT COTES_UNQ1;');
    Script.Add('ALTER TABLE COTES_PARABD DROP CONSTRAINT COTES_PARABD_UNQ1;');
    Script.Add('ALTER TABLE LISTES DROP CONSTRAINT LISTES_UNQID;');
    Script.Add('ALTER TABLE OPTIONS DROP CONSTRAINT OPTIONS_UNQID;');

    Script.Add('ALTER TRIGGER ALBUMS_UNIQID_BIU0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  --');
    Script.Add('end;');
    Script.Add('ALTER TABLE ALBUMS ALTER ID_ALBUMS TO ID_ALBUM;');
    Script.Add('ALTER TRIGGER ALBUMS_UNIQID_BIU0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  if (new.ID_ALBUM is null) then new.ID_ALBUM = old.ID_ALBUM;');
    Script.Add('  if (new.ID_ALBUM is null) then new.ID_ALBUM = UDF_CREATEGUID();');
    Script.Add('');
    Script.Add('  if (new.DC_ALBUMS is null) then new.DC_ALBUMS = old.DC_ALBUMS;');
    Script.Add('');
    Script.Add('  new.DM_ALBUMS = cast(''now'' as timestamp);');
    Script.Add('  if (inserting or new.DC_ALBUMS is null) then new.DC_ALBUMS = new.DM_ALBUMS;');
    Script.Add('end;');

    Script.Add('ALTER TRIGGER AUTEURS_UNIQID_BIU0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  --');
    Script.Add('end;');
    Script.Add('ALTER TABLE AUTEURS ALTER ID_AUTEURS TO ID_AUTEUR;');
    Script.Add('ALTER TRIGGER AUTEURS_UNIQID_BIU0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  if (new.ID_AUTEUR is null) then new.ID_AUTEUR = old.ID_AUTEUR;');
    Script.Add('  if (new.ID_AUTEUR is null) then new.ID_AUTEUR = UDF_CREATEGUID();');
    Script.Add('');
    Script.Add('  if (new.DC_AUTEURS is null) then new.DC_AUTEURS = old.DC_AUTEURS;');
    Script.Add('');
    Script.Add('  new.DM_AUTEURS = cast(''now'' as timestamp);');
    Script.Add('  if (inserting or new.DC_AUTEURS is null) then new.DC_AUTEURS = new.DM_AUTEURS;');
    Script.Add('end;');

    Script.Add('ALTER TRIGGER AUTEURS_PARABD_UNIQID_BIU0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  --');
    Script.Add('end;');
    Script.Add('ALTER TABLE AUTEURS_PARABD ALTER ID_AUTEURS_PARABD TO ID_AUTEUR_PARABD;');
    Script.Add('ALTER TRIGGER AUTEURS_PARABD_UNIQID_BIU0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  if (new.ID_AUTEUR_PARABD is null) then new.ID_AUTEUR_PARABD = old.ID_AUTEUR_PARABD;');
    Script.Add('  if (new.ID_AUTEUR_PARABD is null) then new.ID_AUTEUR_PARABD = UDF_CREATEGUID();');
    Script.Add('');
    Script.Add('  if (new.DC_AUTEURS_PARABD is null) then new.DC_AUTEURS_PARABD = old.DC_AUTEURS_PARABD;');
    Script.Add('');
    Script.Add('  new.DM_AUTEURS_PARABD = cast(''now'' as timestamp);');
    Script.Add('  if (inserting or new.DC_AUTEURS_PARABD is null) then new.DC_AUTEURS_PARABD = new.DM_AUTEURS_PARABD;');
    Script.Add('end;');

    Script.Add('ALTER TRIGGER AUTEURS_SERIES_UNIQID_BIU0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  --');
    Script.Add('end;');
    Script.Add('ALTER TABLE AUTEURS_SERIES ALTER ID_AUTEURS_SERIES TO ID_AUTEUR_SERIES;');
    Script.Add('ALTER TRIGGER AUTEURS_SERIES_UNIQID_BIU0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  if (new.ID_AUTEUR_SERIES is null) then new.ID_AUTEUR_SERIES = old.ID_AUTEUR_SERIES;');
    Script.Add('  if (new.ID_AUTEUR_SERIES is null) then new.ID_AUTEUR_SERIES = UDF_CREATEGUID();');
    Script.Add('');
    Script.Add('  if (new.DC_AUTEURS_SERIES is null) then new.DC_AUTEURS_SERIES = old.DC_AUTEURS_SERIES;');
    Script.Add('');
    Script.Add('  new.DM_AUTEURS_SERIES = cast(''now'' as timestamp);');
    Script.Add('  if (inserting or new.DC_AUTEURS_SERIES is null) then new.DC_AUTEURS_SERIES = new.DM_AUTEURS_SERIES;');
    Script.Add('end;');

    Script.Add('ALTER TRIGGER COLLECTIONS_UNIQID_BIU0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  --');
    Script.Add('end;');
    Script.Add('ALTER TABLE COLLECTIONS ALTER ID_COLLECTIONS TO ID_COLLECTION;');
    Script.Add('ALTER TRIGGER COLLECTIONS_UNIQID_BIU0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  if (new.ID_COLLECTION is null) then new.ID_COLLECTION = old.ID_COLLECTION;');
    Script.Add('  if (new.ID_COLLECTION is null) then new.ID_COLLECTION = UDF_CREATEGUID();');
    Script.Add('');
    Script.Add('  if (new.DC_COLLECTIONS is null) then new.DC_COLLECTIONS = old.DC_COLLECTIONS;');
    Script.Add('');
    Script.Add('  new.DM_COLLECTIONS = cast(''now'' as timestamp);');
    Script.Add('  if (inserting or new.DC_COLLECTIONS is null) then new.DC_COLLECTIONS = new.DM_COLLECTIONS;');
    Script.Add('end;');

    Script.Add('ALTER TRIGGER CONVERSIONS_UNIQID_BIU0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  --');
    Script.Add('end;');
    Script.Add('ALTER TABLE CONVERSIONS ALTER ID_CONVERSIONS TO ID_CONVERSION;');
    Script.Add('ALTER TRIGGER CONVERSIONS_UNIQID_BIU0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  if (new.ID_CONVERSION is null) then new.ID_CONVERSION = old.ID_CONVERSION;');
    Script.Add('  if (new.ID_CONVERSION is null) then new.ID_CONVERSION = UDF_CREATEGUID();');
    Script.Add('');
    Script.Add('  if (new.DC_CONVERSIONS is null) then new.DC_CONVERSIONS = old.DC_CONVERSIONS;');
    Script.Add('');
    Script.Add('  new.DM_CONVERSIONS = cast(''now'' as timestamp);');
    Script.Add('  if (inserting or new.DC_CONVERSIONS is null) then new.DC_CONVERSIONS = new.DM_CONVERSIONS;');
    Script.Add('end;');

    Script.Add('ALTER TRIGGER COTES_UNIQID_BIU0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  --');
    Script.Add('end;');
    Script.Add('ALTER TABLE COTES ALTER ID_COTES TO ID_COTE;');
    Script.Add('ALTER TRIGGER COTES_UNIQID_BIU0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  if (new.ID_COTE is null) then new.ID_COTE = old.ID_COTE;');
    Script.Add('  if (new.ID_COTE is null) then new.ID_COTE = UDF_CREATEGUID();');
    Script.Add('');
    Script.Add('  if (new.DC_COTES is null) then new.DC_COTES = old.DC_COTES;');
    Script.Add('');
    Script.Add('  new.DM_COTES = cast(''now'' as timestamp);');
    Script.Add('  if (inserting or new.DC_COTES is null) then new.DC_COTES = new.DM_COTES;');
    Script.Add('end;');

    Script.Add('ALTER TRIGGER COTES_PARABD_UNIQID_BIU0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  --');
    Script.Add('end;');
    Script.Add('ALTER TABLE COTES_PARABD ALTER ID_COTES_PARABD TO ID_COTE_PARABD;');
    Script.Add('ALTER TRIGGER COTES_PARABD_UNIQID_BIU0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  if (new.ID_COTE_PARABD is null) then new.ID_COTE_PARABD = old.ID_COTE_PARABD;');
    Script.Add('  if (new.ID_COTE_PARABD is null) then new.ID_COTE_PARABD = UDF_CREATEGUID();');
    Script.Add('');
    Script.Add('  if (new.DC_COTES_PARABD is null) then new.DC_COTES_PARABD = old.DC_COTES_PARABD;');
    Script.Add('');
    Script.Add('  new.DM_COTES_PARABD = cast(''now'' as timestamp);');
    Script.Add('  if (inserting or new.DC_COTES_PARABD is null) then new.DC_COTES_PARABD = new.DM_COTES_PARABD;');
    Script.Add('end;');

    Script.Add('ALTER TRIGGER COUVERTURES_UNIQID_BIU0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  --');
    Script.Add('end;');
    Script.Add('ALTER TABLE COUVERTURES ALTER ID_COUVERTURES TO ID_COUVERTURE;');
    Script.Add('ALTER TRIGGER COUVERTURES_UNIQID_BIU0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  if (new.ID_COUVERTURE is null) then new.ID_COUVERTURE = old.ID_COUVERTURE;');
    Script.Add('  if (new.ID_COUVERTURE is null) then new.ID_COUVERTURE = UDF_CREATEGUID();');
    Script.Add('');
    Script.Add('  if (new.DC_COUVERTURES is null) then new.DC_COUVERTURES = old.DC_COUVERTURES;');
    Script.Add('');
    Script.Add('  new.DM_COUVERTURES = cast(''now'' as timestamp);');
    Script.Add('  if (inserting or new.DC_COUVERTURES is null) then new.DC_COUVERTURES = new.DM_COUVERTURES;');
    Script.Add('end;');

    Script.Add('ALTER TRIGGER EDITEURS_UNIQID_BIU0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  --');
    Script.Add('end;');
    Script.Add('ALTER TABLE EDITEURS ALTER ID_EDITEURS TO ID_EDITEUR;');
    Script.Add('ALTER TRIGGER EDITEURS_UNIQID_BIU0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  if (new.ID_EDITEUR is null) then new.ID_EDITEUR = old.ID_EDITEUR;');
    Script.Add('  if (new.ID_EDITEUR is null) then new.ID_EDITEUR = UDF_CREATEGUID();');
    Script.Add('');
    Script.Add('  if (new.DC_EDITEURS is null) then new.DC_EDITEURS = old.DC_EDITEURS;');
    Script.Add('');
    Script.Add('  new.DM_EDITEURS = cast(''now'' as timestamp);');
    Script.Add('  if (inserting or new.DC_EDITEURS is null) then new.DC_EDITEURS = new.DM_EDITEURS;');
    Script.Add('end;');

    Script.Add('ALTER TRIGGER EDITIONS_UNIQID_BIU0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  --');
    Script.Add('end;');
    Script.Add('ALTER TABLE EDITIONS ALTER ID_EDITIONS TO ID_EDITION;');
    Script.Add('ALTER TRIGGER EDITIONS_UNIQID_BIU0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  if (new.ID_EDITION is null) then new.ID_EDITION = old.ID_EDITION;');
    Script.Add('  if (new.ID_EDITION is null) then new.ID_EDITION = UDF_CREATEGUID();');
    Script.Add('');
    Script.Add('  if (new.DC_EDITIONS is null) then new.DC_EDITIONS = old.DC_EDITIONS;');
    Script.Add('');
    Script.Add('  new.DM_EDITIONS = cast(''now'' as timestamp);');
    Script.Add('  if (inserting or new.DC_EDITIONS is null) then new.DC_EDITIONS = new.DM_EDITIONS;');
    Script.Add('end;');

    Script.Add('ALTER TRIGGER EMPRUNTEURS_UNIQID_BIU0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  --');
    Script.Add('end;');
    Script.Add('ALTER TABLE EMPRUNTEURS ALTER ID_EMPRUNTEURS TO ID_EMPRUNTEUR;');
    Script.Add('ALTER TRIGGER EMPRUNTEURS_UNIQID_BIU0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  if (new.ID_EMPRUNTEUR is null) then new.ID_EMPRUNTEUR = old.ID_EMPRUNTEUR;');
    Script.Add('  if (new.ID_EMPRUNTEUR is null) then new.ID_EMPRUNTEUR = UDF_CREATEGUID();');
    Script.Add('');
    Script.Add('  if (new.DC_EMPRUNTEURS is null) then new.DC_EMPRUNTEURS = old.DC_EMPRUNTEURS;');
    Script.Add('');
    Script.Add('  new.DM_EMPRUNTEURS = cast(''now'' as timestamp);');
    Script.Add('  if (inserting or new.DC_EMPRUNTEURS is null) then new.DC_EMPRUNTEURS = new.DM_EMPRUNTEURS;');
    Script.Add('end;');

    Script.Add('ALTER TRIGGER GENRES_UNIQID_BIU0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  --');
    Script.Add('end;');
    Script.Add('ALTER TABLE GENRES ALTER ID_GENRES TO ID_GENRE;');
    Script.Add('ALTER TRIGGER GENRES_UNIQID_BIU0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  if (new.ID_GENRE is null) then new.ID_GENRE = old.ID_GENRE;');
    Script.Add('  if (new.ID_GENRE is null) then new.ID_GENRE = UDF_CREATEGUID();');
    Script.Add('');
    Script.Add('  if (new.DC_GENRES is null) then new.DC_GENRES = old.DC_GENRES;');
    Script.Add('');
    Script.Add('  new.DM_GENRES = cast(''now'' as timestamp);');
    Script.Add('  if (inserting or new.DC_GENRES is null) then new.DC_GENRES = new.DM_GENRES;');
    Script.Add('end;');

    Script.Add('ALTER TRIGGER LISTES_UNIQID_BIU0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  --');
    Script.Add('end;');
    Script.Add('ALTER TABLE LISTES ALTER ID_LISTES TO ID_LISTE;');
    Script.Add('ALTER TRIGGER LISTES_UNIQID_BIU0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  if (new.ID_LISTE is null) then new.ID_LISTE = old.ID_LISTE;');
    Script.Add('  if (new.ID_LISTE is null) then new.ID_LISTE = UDF_CREATEGUID();');
    Script.Add('');
    Script.Add('  if (new.DC_LISTES is null) then new.DC_LISTES = old.DC_LISTES;');
    Script.Add('');
    Script.Add('  new.DM_LISTES = cast(''now'' as timestamp);');
    Script.Add('  if (inserting or new.DC_LISTES is null) then new.DC_LISTES = new.DM_LISTES;');
    Script.Add('end;');

    Script.Add('ALTER TRIGGER OPTIONS_UNIQID_BIU0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  --');
    Script.Add('end;');
    Script.Add('ALTER TABLE OPTIONS ALTER ID_OPTIONS TO ID_OPTION;');
    Script.Add('ALTER TRIGGER OPTIONS_UNIQID_BIU0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  if (new.ID_OPTION is null) then new.ID_OPTION = old.ID_OPTION;');
    Script.Add('  if (new.ID_OPTION is null) then new.ID_OPTION = UDF_CREATEGUID();');
    Script.Add('');
    Script.Add('  if (new.DC_OPTIONS is null) then new.DC_OPTIONS = old.DC_OPTIONS;');
    Script.Add('');
    Script.Add('  new.DM_OPTIONS = cast(''now'' as timestamp);');
    Script.Add('  if (inserting or new.DC_OPTIONS is null) then new.DC_OPTIONS = new.DM_OPTIONS;');
    Script.Add('end;');

    Script.Add('ALTER TRIGGER PERSONNES_UNIQID_BIU0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  --');
    Script.Add('end;');
    Script.Add('ALTER TABLE PERSONNES ALTER ID_PERSONNES TO ID_PERSONNE;');
    Script.Add('ALTER TRIGGER PERSONNES_UNIQID_BIU0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  if (new.ID_PERSONNE is null) then new.ID_PERSONNE = old.ID_PERSONNE;');
    Script.Add('  if (new.ID_PERSONNE is null) then new.ID_PERSONNE = UDF_CREATEGUID();');
    Script.Add('');
    Script.Add('  if (new.DC_PERSONNES is null) then new.DC_PERSONNES = old.DC_PERSONNES;');
    Script.Add('');
    Script.Add('  new.DM_PERSONNES = cast(''now'' as timestamp);');
    Script.Add('  if (inserting or new.DC_PERSONNES is null) then new.DC_PERSONNES = new.DM_PERSONNES;');
    Script.Add('end;');

    Script.Add('ALTER TRIGGER SERIES_UNIQID_BIU0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  --');
    Script.Add('end;');
    Script.Add('ALTER TABLE SERIES ALTER ID_SERIES TO ID_SERIE;');
    Script.Add('ALTER TRIGGER SERIES_UNIQID_BIU0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  if (new.ID_SERIE is null) then new.ID_SERIE = old.ID_SERIE;');
    Script.Add('  if (new.ID_SERIE is null) then new.ID_SERIE = UDF_CREATEGUID();');
    Script.Add('');
    Script.Add('  if (new.DC_SERIES is null) then new.DC_SERIES = old.DC_SERIES;');
    Script.Add('');
    Script.Add('  new.DM_SERIES = cast(''now'' as timestamp);');
    Script.Add('  if (inserting or new.DC_SERIES is null) then new.DC_SERIES = new.DM_SERIES;');
    Script.Add('end;');

    Script.Add('ALTER TABLE AUTEURS ADD CONSTRAINT AUTEURS_UNQID UNIQUE (ID_AUTEUR);');
    Script.Add('ALTER TABLE AUTEURS_PARABD ADD CONSTRAINT AUTEURS_PARABD_UNQID UNIQUE (ID_AUTEUR_PARABD);');
    Script.Add('ALTER TABLE AUTEURS_SERIES ADD CONSTRAINT AUTEURS_SERIES_UNQID UNIQUE (ID_AUTEUR_SERIES);');
    Script.Add('ALTER TABLE CONVERSIONS ADD CONSTRAINT CONVERSIONS_UNQID UNIQUE (ID_CONVERSION);');
    Script.Add('ALTER TABLE COTES ADD CONSTRAINT COTES_UNQID UNIQUE (ID_COTE);');
    Script.Add('ALTER TABLE COTES_PARABD ADD CONSTRAINT COTES_PARABD_UNQID UNIQUE (ID_COTE_PARABD);');
    Script.Add('ALTER TABLE LISTES ADD CONSTRAINT LISTES_UNQID UNIQUE (ID_LISTE);');
    Script.Add('ALTER TABLE OPTIONS ADD CONSTRAINT OPTIONS_UNQID UNIQUE (ID_OPTION);');

    Script.Add('ALTER TABLE ALBUMS ADD CONSTRAINT ALBUMS_PK PRIMARY KEY (ID_ALBUM) USING INDEX ALBUMS_PK;');
    Script.Add('ALTER TABLE AUTEURS ADD CONSTRAINT AUTEURS_PK PRIMARY KEY (ID_ALBUM, ID_PERSONNE, METIER) USING INDEX AUTEURS_PK;');
    Script.Add('ALTER TABLE AUTEURS_PARABD ADD CONSTRAINT AUTEURS_PARABD_PK PRIMARY KEY (ID_PARABD, ID_PERSONNE) USING INDEX AUTEURS_PARABD_PK;');
    Script.Add('ALTER TABLE AUTEURS_SERIES ADD CONSTRAINT AUTEURS_SERIES_PK PRIMARY KEY (ID_SERIE, ID_PERSONNE, METIER) USING INDEX AUTEURS_SERIES_PK;');
    Script.Add('ALTER TABLE COLLECTIONS ADD CONSTRAINT COLLECTIONS_PK PRIMARY KEY (ID_COLLECTION) USING INDEX COLLECTIONS_PK;');
    Script.Add('ALTER TABLE COTES ADD CONSTRAINT COTES_PK PRIMARY KEY (ANNEECOTE, ID_EDITION) USING INDEX COTES_PK;');
    Script.Add('ALTER TABLE COTES_PARABD ADD CONSTRAINT COTES_PARABD_PK PRIMARY KEY (ANNEECOTE, ID_PARABD) USING INDEX COTES_PARABD_PK;');
    Script.Add('ALTER TABLE COUVERTURES ADD CONSTRAINT COUVERTURES_PK PRIMARY KEY (ID_COUVERTURE) USING INDEX COUVERTURES_PK;');
    Script.Add('ALTER TABLE EDITEURS ADD CONSTRAINT EDITEURS_PK PRIMARY KEY (ID_EDITEUR) USING INDEX EDITEURS_PK;');
    Script.Add('ALTER TABLE EDITIONS ADD CONSTRAINT EDITIONS_PK PRIMARY KEY (ID_EDITION) USING INDEX EDITIONS_PK;');
    Script.Add('ALTER TABLE EMPRUNTEURS ADD CONSTRAINT EMPRUNTEURS_PK PRIMARY KEY (ID_EMPRUNTEUR) USING INDEX EMPRUNTEURS_PK;');
    Script.Add('ALTER TABLE ENTRETIENT ADD CONSTRAINT ENTRETIENT_PK PRIMARY KEY (ID_ENTRETIENT) USING INDEX ENTRETIENT_PK;');
    Script.Add('ALTER TABLE GENRES ADD CONSTRAINT GENRES_PK PRIMARY KEY (ID_GENRE) USING INDEX GENRES_PK;');
    Script.Add('ALTER TABLE GENRESERIES ADD CONSTRAINT GENRESERIES_PK PRIMARY KEY (ID_SERIE, ID_GENRE) USING INDEX GENRESERIES_PK;');
    Script.Add('ALTER TABLE PARABD ADD CONSTRAINT PARABD_PK PRIMARY KEY (ID_PARABD) USING INDEX PARABD_PK;');
    Script.Add('ALTER TABLE PERSONNES ADD CONSTRAINT PERSONNES_PK PRIMARY KEY (ID_PERSONNE) USING INDEX PERSONNES_PK;');
    Script.Add('ALTER TABLE SERIES ADD CONSTRAINT SERIES_PK PRIMARY KEY (ID_SERIE) USING INDEX SERIES_PK;');
    Script.Add('ALTER TABLE STATUT ADD CONSTRAINT STATUT_PK PRIMARY KEY (ID_STATUT) USING INDEX STATUT_PK;');

    Script.Add('ALTER TABLE ALBUMS ADD CONSTRAINT ALBUMS_FK1 FOREIGN KEY (ID_SERIE) REFERENCES SERIES (ID_SERIE) ON DELETE CASCADE ON UPDATE CASCADE;');
    Script.Add('ALTER TABLE AUTEURS ADD CONSTRAINT AUTEURS_FK1 FOREIGN KEY (ID_ALBUM) REFERENCES ALBUMS (ID_ALBUM) ON DELETE CASCADE ON UPDATE CASCADE;');
    Script.Add('ALTER TABLE AUTEURS ADD CONSTRAINT AUTEURS_FK2 FOREIGN KEY (ID_PERSONNE) REFERENCES PERSONNES (ID_PERSONNE) ON DELETE CASCADE ON UPDATE CASCADE;');
    Script.Add('ALTER TABLE AUTEURS_PARABD ADD CONSTRAINT AUTEURS_PARABD_FK1 FOREIGN KEY (ID_PARABD) REFERENCES PARABD (ID_PARABD) ON DELETE CASCADE ON UPDATE CASCADE;');
    Script.Add('ALTER TABLE AUTEURS_PARABD ADD CONSTRAINT AUTEURS_PARABD_FK2 FOREIGN KEY (ID_PERSONNE) REFERENCES PERSONNES (ID_PERSONNE) ON DELETE CASCADE ON UPDATE CASCADE;');
    Script.Add('ALTER TABLE AUTEURS_SERIES ADD CONSTRAINT AUTEURS_SERIES_FK1 FOREIGN KEY (ID_SERIE) REFERENCES SERIES (ID_SERIE) ON DELETE CASCADE ON UPDATE CASCADE;');
    Script.Add('ALTER TABLE AUTEURS_SERIES ADD CONSTRAINT AUTEURS_SERIES_FK2 FOREIGN KEY (ID_PERSONNE) REFERENCES PERSONNES (ID_PERSONNE) ON DELETE CASCADE ON UPDATE CASCADE;');
    Script.Add('ALTER TABLE COLLECTIONS ADD CONSTRAINT COLLECTIONS_FK1 FOREIGN KEY (ID_EDITEUR) REFERENCES EDITEURS (ID_EDITEUR) ON DELETE CASCADE ON UPDATE CASCADE;');
    Script.Add('ALTER TABLE COTES ADD CONSTRAINT COTES_FK1 FOREIGN KEY (ID_EDITION) REFERENCES EDITIONS (ID_EDITION) ON DELETE CASCADE ON UPDATE CASCADE;');
    Script.Add('ALTER TABLE COTES_PARABD ADD CONSTRAINT COTES_PARABD_FK1 FOREIGN KEY (ID_PARABD) REFERENCES PARABD (ID_PARABD) ON DELETE CASCADE ON UPDATE CASCADE;');
    Script.Add('ALTER TABLE COUVERTURES ADD CONSTRAINT COUVERTURES_FK1 FOREIGN KEY (ID_ALBUM) REFERENCES ALBUMS (ID_ALBUM) ON DELETE CASCADE ON UPDATE CASCADE;');
    Script.Add('ALTER TABLE EDITIONS ADD CONSTRAINT EDITIONS_FK1 FOREIGN KEY (ID_EDITEUR) REFERENCES EDITEURS (ID_EDITEUR) ON DELETE CASCADE ON UPDATE CASCADE;');
    Script.Add('ALTER TABLE EDITIONS ADD CONSTRAINT EDITIONS_FK2 FOREIGN KEY (ID_ALBUM) REFERENCES ALBUMS (ID_ALBUM) ON DELETE CASCADE ON UPDATE CASCADE;');
    Script.Add('ALTER TABLE GENRESERIES ADD CONSTRAINT GENRESERIES_FK1 FOREIGN KEY (ID_GENRE) REFERENCES GENRES (ID_GENRE) ON DELETE CASCADE ON UPDATE CASCADE;');
    Script.Add('ALTER TABLE GENRESERIES ADD CONSTRAINT GENRESERIES_FK2 FOREIGN KEY (ID_SERIE) REFERENCES SERIES (ID_SERIE) ON DELETE CASCADE ON UPDATE CASCADE;');
    Script.Add('ALTER TABLE PARABD ADD CONSTRAINT PARABD_FK1 FOREIGN KEY (ID_SERIE) REFERENCES SERIES (ID_SERIE) ON DELETE CASCADE ON UPDATE CASCADE;');
    Script.Add('ALTER TABLE STATUT ADD CONSTRAINT STATUT_FK1 FOREIGN KEY (ID_EDITION) REFERENCES EDITIONS (ID_EDITION) ON DELETE CASCADE ON UPDATE CASCADE;');
    Script.Add('ALTER TABLE STATUT ADD CONSTRAINT STATUT_FK2 FOREIGN KEY (ID_EMPRUNTEUR) REFERENCES EMPRUNTEURS (ID_EMPRUNTEUR) ON DELETE CASCADE ON UPDATE CASCADE;');

    Script.Add('ALTER TRIGGER ALBUMS_AI ACTIVE;');
    Script.Add('ALTER TRIGGER ALBUMS_DV ACTIVE;');
    Script.Add('ALTER TRIGGER ALBUMS_UNIQID_BIU0 ACTIVE;');
    Script.Add('ALTER TRIGGER AUTEURS_PARABD_UNIQID_BIU0 ACTIVE;');
    Script.Add('ALTER TRIGGER AUTEURS_SERIES_UNIQID_BIU0 ACTIVE;');
    Script.Add('ALTER TRIGGER AUTEURS_UNIQID_BIU0 ACTIVE;');
    Script.Add('ALTER TRIGGER COLLECTIONS_AI ACTIVE;');
    Script.Add('ALTER TRIGGER COLLECTIONS_DV ACTIVE;');
    Script.Add('ALTER TRIGGER COLLECTIONS_EDITIONS_REF ACTIVE;');
    Script.Add('ALTER TRIGGER COLLECTIONS_SERIE_REF ACTIVE;');
    Script.Add('ALTER TRIGGER COLLECTIONS_UNIQID_BIU0 ACTIVE;');
    Script.Add('ALTER TRIGGER CONVERSIONS_UNIQID_BIU0 ACTIVE;');
    Script.Add('ALTER TRIGGER COTES_PARABD_UNIQID_BIU0 ACTIVE;');
    Script.Add('ALTER TRIGGER COTES_UNIQID_BIU0 ACTIVE;');
    Script.Add('ALTER TRIGGER COUVERTURES_AI ACTIVE;');
    Script.Add('ALTER TRIGGER COUVERTURES_UNIQID_BIU0 ACTIVE;');
    Script.Add('ALTER TRIGGER CRITEREBOOLEAN_UNIQID_BIU0 ACTIVE;');
    Script.Add('ALTER TRIGGER CRITEREIMAGE_UNIQID_BIU0 ACTIVE;');
    Script.Add('ALTER TRIGGER CRITERELANGUETITRE_UNIQID_BIU0 ACTIVE;');
    Script.Add('ALTER TRIGGER CRITERELISTE_UNIQID_BIU0 ACTIVE;');
    Script.Add('ALTER TRIGGER CRITERENUMERAL_UNIQID_BIU0 ACTIVE;');
    Script.Add('ALTER TRIGGER CRITERESTRING_UNIQID_BIU0 ACTIVE;');
    Script.Add('ALTER TRIGGER CRITERETITRE_UNIQID_BIU0 ACTIVE;');
    Script.Add('ALTER TRIGGER EDITEURS_AI ACTIVE;');
    Script.Add('ALTER TRIGGER EDITEURS_DV ACTIVE;');
    Script.Add('ALTER TRIGGER EDITEURS_SERIE_REF ACTIVE;');
    Script.Add('ALTER TRIGGER EDITEURS_UNIQID_BIU0 ACTIVE;');
    Script.Add('ALTER TRIGGER EDITIONS_AD0 ACTIVE;');
    Script.Add('ALTER TRIGGER EDITIONS_AI ACTIVE;');
    Script.Add('ALTER TRIGGER EDITIONS_AI0 ACTIVE;');
    Script.Add('ALTER TRIGGER EDITIONS_AU0 ACTIVE;');
    Script.Add('ALTER TRIGGER EDITIONS_BU0 ACTIVE;');
    Script.Add('ALTER TRIGGER EDITIONS_COTE_BIU1 ACTIVE;');
    Script.Add('ALTER TRIGGER EDITIONS_UNIQID_BIU0 ACTIVE;');
    Script.Add('ALTER TRIGGER EMPRUNTEURS_AI ACTIVE;');
    Script.Add('ALTER TRIGGER EMPRUNTEURS_DV ACTIVE;');
    Script.Add('ALTER TRIGGER EMPRUNTEURS_UNIQID_BIU0 ACTIVE;');
    Script.Add('ALTER TRIGGER ENTRETIENT_UNIQID_BIU0 ACTIVE;');
    Script.Add('ALTER TRIGGER GENRESERIES_UNIQID_BIU0 ACTIVE;');
    Script.Add('ALTER TRIGGER GENRES_AI ACTIVE;');
    Script.Add('ALTER TRIGGER GENRES_DV ACTIVE;');
    Script.Add('ALTER TRIGGER GENRES_UNIQID_BIU0 ACTIVE;');
    Script.Add('ALTER TRIGGER LISTES_AUD0 ACTIVE;');
    Script.Add('ALTER TRIGGER LISTES_UNIQID_BIU0 ACTIVE;');
    Script.Add('ALTER TRIGGER OPTIONS_UNIQID_BIU0 ACTIVE;');
    Script.Add('ALTER TRIGGER PARABD_AI ACTIVE;');
    Script.Add('ALTER TRIGGER PARABD_COTE_BIU1 ACTIVE;');
    Script.Add('ALTER TRIGGER PARABD_DV ACTIVE;');
    Script.Add('ALTER TRIGGER PARABD_UNIQID_BIU0 ACTIVE;');
    Script.Add('ALTER TRIGGER PERSONNES_AI ACTIVE;');
    Script.Add('ALTER TRIGGER PERSONNES_DV ACTIVE;');
    Script.Add('ALTER TRIGGER PERSONNES_UNIQID_BIU0 ACTIVE;');
    Script.Add('ALTER TRIGGER SERIES_AI ACTIVE;');
    Script.Add('ALTER TRIGGER SERIES_DV ACTIVE;');
    Script.Add('ALTER TRIGGER SERIES_UNIQID_BIU0 ACTIVE;');
    Script.Add('ALTER TRIGGER STATUT_AI ACTIVE;');
    Script.Add('ALTER TRIGGER STATUT_UNIQID_BIU0 ACTIVE;');
    ExecuteScript;
  end;
end;

procedure RecreerVuesProcTrigger(Query: TJvUIBScript);
begin
  with Query do begin
    Script.Clear;

    Script.Add('DROP VIEW VW_EMPRUNTS;');
    Script.Add('CREATE VIEW VW_EMPRUNTS(');
    Script.Add('    ID_STATUT,');
    Script.Add('    ID_EDITION,');
    Script.Add('    ID_ALBUM,');
    Script.Add('    TITREALBUM,');
    Script.Add('    UPPERTITREALBUM,');
    Script.Add('    ID_SERIE,');
    Script.Add('    TOME,');
    Script.Add('    INTEGRALE,');
    Script.Add('    TOMEDEBUT,');
    Script.Add('    TOMEFIN,');
    Script.Add('    HORSSERIE,');
    Script.Add('    TITRESERIE,');
    Script.Add('    ID_EDITEUR,');
    Script.Add('    NOMEDITEUR,');
    Script.Add('    ID_COLLECTION,');
    Script.Add('    NOMCOLLECTION,');
    Script.Add('    PRETE,');
    Script.Add('    ANNEEEDITION,');
    Script.Add('    ISBN,');
    Script.Add('    ID_EMPRUNTEUR,');
    Script.Add('    NOMEMPRUNTEUR,');
    Script.Add('    PRETEMPRUNT,');
    Script.Add('    DATEEMPRUNT)');
    Script.Add('AS');
    Script.Add('SELECT S.id_statut,');
    Script.Add('       Ed.ID_EDITION,');
    Script.Add('       A.ID_ALBUM,');
    Script.Add('       A.titrealbum,');
    Script.Add('       A.uppertitrealbum,');
    Script.Add('       A.id_serie,');
    Script.Add('       A.Tome,');
    Script.Add('       A.Integrale,');
    Script.Add('       A.TomeDebut,');
    Script.Add('       A.TomeFin,');
    Script.Add('       A.HorsSerie,');
    Script.Add('       Se.titreserie,');
    Script.Add('       E.ID_EDITEUR,');
    Script.Add('       E.NomEditeur,');
    Script.Add('       C.ID_COLLECTION,');
    Script.Add('       C.NomCollection,');
    Script.Add('       Ed.prete,');
    Script.Add('       Ed.AnneeEdition,');
    Script.Add('       Ed.ISBN,');
    Script.Add('       Em.ID_EMPRUNTEUR,');
    Script.Add('       Em.NomEmprunteur,');
    Script.Add('       S.PretEmprunt,');
    Script.Add('       S.DateEmprunt');
    Script.Add('FROM ALBUMS A INNER JOIN EDITIONS Ed ON A.ID_ALBUM = Ed.id_album');
    Script.Add('              INNER JOIN EDITEURS e ON e.ID_EDITEUR = ed.id_editeur');
    Script.Add('              LEFT JOIN COLLECTIONS C ON C.ID_COLLECTION = ed.id_collection');
    Script.Add('              INNER JOIN STATUT S ON Ed.ID_EDITION = S.id_edition');
    Script.Add('              INNER JOIN EMPRUNTEURS Em ON Em.ID_EMPRUNTEUR = S.id_emprunteur');
    Script.Add('              INNER JOIN SERIES Se ON A.id_serie = Se.ID_SERIE;');

    Script.Add('DROP VIEW VW_LISTE_GENRES_ALBUMS;');
    Script.Add('DROP VIEW VW_LISTE_EDITEURS_ALBUMS;');
    Script.Add('DROP VIEW VW_LISTE_COLLECTIONS_ALBUMS;');
    Script.Add('DROP VIEW VW_LISTE_ALBUMS;');

    Script.Add('CREATE VIEW VW_LISTE_ALBUMS(');
    Script.Add('    ID_ALBUM,');
    Script.Add('    TITREALBUM,');
    Script.Add('    TOME,');
    Script.Add('    TOMEDEBUT,');
    Script.Add('    TOMEFIN,');
    Script.Add('    HORSSERIE,');
    Script.Add('    INTEGRALE,');
    Script.Add('    MOISPARUTION,');
    Script.Add('    ANNEEPARUTION,');
    Script.Add('    ID_SERIE,');
    Script.Add('    TITRESERIE,');
    Script.Add('    UPPERTITREALBUM,');
    Script.Add('    UPPERTITRESERIE,');
    Script.Add('    ACHAT,');
    Script.Add('    COMPLET)');
    Script.Add('AS');
    Script.Add('select a.ID_ALBUM,');
    Script.Add('       a.TITREALBUM,');
    Script.Add('       a.TOME,');
    Script.Add('       a.TOMEDEBUT,');
    Script.Add('       a.TOMEFIN,');
    Script.Add('       a.HORSSERIE,');
    Script.Add('       a.INTEGRALE,');
    Script.Add('       a.MOISPARUTION,');
    Script.Add('       a.ANNEEPARUTION,');
    Script.Add('       a.ID_SERIE,');
    Script.Add('       s.TITRESERIE,');
    Script.Add('       a.UPPERTITREALBUM,');
    Script.Add('       s.UPPERTITRESERIE,');
    Script.Add('       a.ACHAT,');
    Script.Add('       a.COMPLET');
    Script.Add('FROM ALBUMS a INNER JOIN SERIES s ON s.ID_SERIE = a.id_serie;');

    Script.Add('CREATE VIEW VW_LISTE_COLLECTIONS_ALBUMS(');
    Script.Add('    ID_ALBUM,');
    Script.Add('    TITREALBUM,');
    Script.Add('    TOME,');
    Script.Add('    TOMEDEBUT,');
    Script.Add('    TOMEFIN,');
    Script.Add('    HORSSERIE,');
    Script.Add('    INTEGRALE,');
    Script.Add('    MOISPARUTION,');
    Script.Add('    ANNEEPARUTION,');
    Script.Add('    ID_SERIE,');
    Script.Add('    TITRESERIE,');
    Script.Add('    UPPERTITREALBUM,');
    Script.Add('    ID_COLLECTION,');
    Script.Add('    NOMCOLLECTION,');
    Script.Add('    UPPERNOMCOLLECTION,');
    Script.Add('    UPPERTITRESERIE,');
    Script.Add('    ACHAT,');
    Script.Add('    COMPLET)');
    Script.Add('AS');
    Script.Add('select a.ID_ALBUM,');
    Script.Add('       a.TITREALBUM,');
    Script.Add('       a.TOME,');
    Script.Add('       a.TOMEDEBUT,');
    Script.Add('       a.TOMEFIN,');
    Script.Add('       a.HORSSERIE,');
    Script.Add('       a.INTEGRALE,');
    Script.Add('       a.MOISPARUTION,');
    Script.Add('       a.ANNEEPARUTION,');
    Script.Add('       a.ID_SERIE,');
    Script.Add('       a.TITRESERIE,');
    Script.Add('       a.UPPERTITREALBUM,');
    Script.Add('       c.ID_COLLECTION,');
    Script.Add('       c.NOMCOLLECTION,');
    Script.Add('       c.UPPERNOMCOLLECTION,');
    Script.Add('       a.UPPERTITRESERIE,');
    Script.Add('       a.ACHAT,');
    Script.Add('       a.COMPLET');
    Script.Add('FROM VW_LISTE_ALBUMS a LEFT JOIN EDITIONS e ON e.id_album = a.id_album');
    Script.Add('                       LEFT JOIN COLLECTIONS c ON e.id_collection = c.ID_COLLECTION;');

    Script.Add('CREATE VIEW VW_LISTE_EDITEURS_ALBUMS(');
    Script.Add('    ID_ALBUM,');
    Script.Add('    TITREALBUM,');
    Script.Add('    TOME,');
    Script.Add('    TOMEDEBUT,');
    Script.Add('    TOMEFIN,');
    Script.Add('    HORSSERIE,');
    Script.Add('    INTEGRALE,');
    Script.Add('    MOISPARUTION,');
    Script.Add('    ANNEEPARUTION,');
    Script.Add('    ID_SERIE,');
    Script.Add('    TITRESERIE,');
    Script.Add('    UPPERTITREALBUM,');
    Script.Add('    ID_EDITEUR,');
    Script.Add('    NOMEDITEUR,');
    Script.Add('    UPPERNOMEDITEUR,');
    Script.Add('    UPPERTITRESERIE,');
    Script.Add('    ACHAT,');
    Script.Add('    COMPLET)');
    Script.Add('AS');
    Script.Add('select a.ID_ALBUM,');
    Script.Add('       a.TITREALBUM,');
    Script.Add('       a.TOME,');
    Script.Add('       a.TOMEDEBUT,');
    Script.Add('       a.TOMEFIN,');
    Script.Add('       a.HORSSERIE,');
    Script.Add('       a.INTEGRALE,');
    Script.Add('       a.MOISPARUTION,');
    Script.Add('       a.ANNEEPARUTION,');
    Script.Add('       a.ID_SERIE,');
    Script.Add('       a.TITRESERIE,');
    Script.Add('       a.UPPERTITREALBUM,');
    Script.Add('       e.ID_EDITEUR,');
    Script.Add('       e.NOMEDITEUR,');
    Script.Add('       e.UPPERNOMEDITEUR,');
    Script.Add('       a.UPPERTITRESERIE,');
    Script.Add('       a.ACHAT,');
    Script.Add('       a.COMPLET');
    Script.Add('FROM VW_LISTE_ALBUMS a LEFT JOIN EDITIONS ed ON ed.id_album = a.id_album');
    Script.Add('                       LEFT JOIN EDITEURS e ON e.ID_EDITEUR = ed.id_editeur;');

    Script.Add('CREATE VIEW VW_LISTE_GENRES_ALBUMS(');
    Script.Add('    ID_ALBUM,');
    Script.Add('    TITREALBUM,');
    Script.Add('    TOME,');
    Script.Add('    TOMEDEBUT,');
    Script.Add('    TOMEFIN,');
    Script.Add('    HORSSERIE,');
    Script.Add('    INTEGRALE,');
    Script.Add('    MOISPARUTION,');
    Script.Add('    ANNEEPARUTION,');
    Script.Add('    ID_SERIE,');
    Script.Add('    TITRESERIE,');
    Script.Add('    UPPERTITREALBUM,');
    Script.Add('    ID_GENRE,');
    Script.Add('    GENRE,');
    Script.Add('    UPPERGENRE,');
    Script.Add('    UPPERTITRESERIE,');
    Script.Add('    ACHAT,');
    Script.Add('    COMPLET)');
    Script.Add('AS');
    Script.Add('select a.ID_ALBUM,');
    Script.Add('       a.TITREALBUM,');
    Script.Add('       a.TOME,');
    Script.Add('       a.TOMEDEBUT,');
    Script.Add('       a.TOMEFIN,');
    Script.Add('       a.HORSSERIE,');
    Script.Add('       a.INTEGRALE,');
    Script.Add('       a.MOISPARUTION,');
    Script.Add('       a.ANNEEPARUTION,');
    Script.Add('       a.ID_SERIE,');
    Script.Add('       a.TITRESERIE,');
    Script.Add('       a.UPPERTITREALBUM,');
    Script.Add('       g.ID_GENRE,');
    Script.Add('       g.GENRE,');
    Script.Add('       g.UPPERGENRE,');
    Script.Add('       a.UPPERTITRESERIE,');
    Script.Add('       a.ACHAT,');
    Script.Add('       a.COMPLET');
    Script.Add('FROM VW_LISTE_ALBUMS a LEFT JOIN GENRESERIES gs ON gs.id_serie = a.id_serie');
    Script.Add('                       LEFT JOIN GENRES g ON gs.id_genre = g.ID_GENRE;');

    Script.Add('DROP VIEW VW_PRIXUNITAIRES;');
    Script.Add('DROP VIEW VW_PRIXALBUMS;');

    Script.Add('CREATE VIEW VW_PRIXALBUMS(');
    Script.Add('    ID_ALBUM,');
    Script.Add('    HORSSERIE,');
    Script.Add('    TOME,');
    Script.Add('    INTEGRALE,');
    Script.Add('    TOMEDEBUT,');
    Script.Add('    TOMEFIN,');
    Script.Add('    NBALBUMS,');
    Script.Add('    ID_SERIE,');
    Script.Add('    ID_EDITION,');
    Script.Add('    ID_EDITEUR,');
    Script.Add('    PRIX)');
    Script.Add('AS');
    Script.Add('select');
    Script.Add('  a.ID_ALBUM,');
    Script.Add('  a.horsserie,');
    Script.Add('  a.tome,');
    Script.Add('  a.integrale,');
    Script.Add('  a.tomedebut,');
    Script.Add('  a.tomefin,');
    Script.Add('  case');
    Script.Add('    when a.integrale = 0 then 1');
    Script.Add('    when a.tomedebut is null');
    Script.Add('    then 1 when a.tomefin is null');
    Script.Add('    then 1 when a.tomefin < a.tomedebut then 1');
    Script.Add('    else a.tomefin - a.tomedebut + 1');
    Script.Add('  end as nbalbums,');
    Script.Add('  a.id_serie,');
    Script.Add('  e.ID_EDITION,');
    Script.Add('  e.id_editeur,');
    Script.Add('  e.prix');
    Script.Add('from albums a');
    Script.Add('  inner join editions e on a.ID_ALBUM = e.id_album;');

    Script.Add('CREATE VIEW VW_PRIXUNITAIRES(');
    Script.Add('    HORSSERIE,');
    Script.Add('    ID_SERIE,');
    Script.Add('    ID_EDITEUR,');
    Script.Add('    PRIXUNITAIRE)');
    Script.Add('AS');
    Script.Add('select');
    Script.Add('  horsserie,');
    Script.Add('  id_serie,');
    Script.Add('  id_editeur,');
    Script.Add('  avg(prix / nbalbums) as prixunitaire');
    Script.Add('from vw_prixalbums');
    Script.Add('where');
    Script.Add('  prix is not null');
    Script.Add('group by');
    Script.Add('  id_serie,');
    Script.Add('  horsserie,');
    Script.Add('  id_editeur;');

    Script.Add('ALTER PROCEDURE PROC_EMPRUNTS');
    Script.Add('RETURNS (');
    Script.Add('    ID_EDITION CHAR(38) CHARACTER SET NONE,');
    Script.Add('    ID_ALBUM CHAR(38) CHARACTER SET NONE,');
    Script.Add('    TITREALBUM VARCHAR(150),');
    Script.Add('    ID_SERIE CHAR(38) CHARACTER SET NONE,');
    Script.Add('    TITRESERIE VARCHAR(150),');
    Script.Add('    PRETE SMALLINT,');
    Script.Add('    ID_EMPRUNTEUR CHAR(38) CHARACTER SET NONE,');
    Script.Add('    NOMEMPRUNTEUR VARCHAR(150),');
    Script.Add('    PRETEMPRUNT SMALLINT,');
    Script.Add('    DATEEMPRUNT TIMESTAMP)');
    Script.Add('AS');
    Script.Add('BEGIN');
    Script.Add('  FOR SELECT Ed.ID_EDITION,');
    Script.Add('             A.ID_ALBUM,');
    Script.Add('             A.titrealbum,');
    Script.Add('             A.id_serie,');
    Script.Add('             Se.titreserie,');
    Script.Add('             Ed.prete,');
    Script.Add('             E.ID_EMPRUNTEUR,');
    Script.Add('             E.NomEmprunteur,');
    Script.Add('             S.PretEmprunt,');
    Script.Add('             S.DateEmprunt');
    Script.Add('      FROM ALBUMS A INNER JOIN EDITIONS Ed ON A.ID_ALBUM = Ed.id_album');
    Script.Add('                    INNER JOIN STATUT S ON Ed.ID_EDITION = S.id_edition');
    Script.Add('                    INNER JOIN EMPRUNTEURS E ON E.ID_EMPRUNTEUR = S.id_emprunteur');
    Script.Add('                    INNER JOIN SERIES Se ON A.id_serie = Se.ID_SERIE');
    Script.Add('      ORDER BY S.DateEmprunt DESC');
    Script.Add('      INTO :ID_EDITION,');
    Script.Add('           :ID_ALBUM,');
    Script.Add('           :TITREALBUM,');
    Script.Add('           :ID_SERIE,');
    Script.Add('           :TITRESERIE,');
    Script.Add('           :PRETE,');
    Script.Add('           :ID_Emprunteur,');
    Script.Add('           :NomEmprunteur,');
    Script.Add('           :PretEmprunt,');
    Script.Add('           :DateEmprunt');
    Script.Add('  DO');
    Script.Add('  BEGIN');
    Script.Add('    SUSPEND;');
    Script.Add('  END');
    Script.Add('END;');

    Script.Add('ALTER PROCEDURE PREVISIONS_SORTIES (');
    Script.Add('    WITHACHAT SMALLINT,');
    Script.Add('    IN_ID_SERIE CHAR(38) CHARACTER SET NONE)');
    Script.Add('RETURNS (');
    Script.Add('    ID_SERIE CHAR(38) CHARACTER SET NONE,');
    Script.Add('    TITRESERIE VARCHAR(150),');
    Script.Add('    UPPERTITRESERIE VARCHAR(150),');
    Script.Add('    TOME INTEGER,');
    Script.Add('    ANNEEPARUTION INTEGER,');
    Script.Add('    MOISPARUTION INTEGER,');
    Script.Add('    ID_EDITEUR CHAR(38) CHARACTER SET NONE,');
    Script.Add('    NOMEDITEUR VARCHAR(50),');
    Script.Add('    ID_COLLECTION CHAR(38) CHARACTER SET NONE,');
    Script.Add('    NOMCOLLECTION VARCHAR(50))');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  --');
    Script.Add('end;');

    Script.Add('ALTER PROCEDURE CALCUL_ANNEE_SORTIE (');
    Script.Add('    WITHACHAT SMALLINT,');
    Script.Add('    IN_IDSERIE CHAR(38) CHARACTER SET NONE,');
    Script.Add('    SOMMEPONDEREE INTEGER,');
    Script.Add('    COMPTEALBUM INTEGER,');
    Script.Add('    MAXTOME INTEGER,');
    Script.Add('    MAXANNEE INTEGER,');
    Script.Add('    MAXMOIS INTEGER)');
    Script.Add('RETURNS (');
    Script.Add('    ID_SERIE CHAR(38) CHARACTER SET NONE,');
    Script.Add('    TITRESERIE VARCHAR(150),');
    Script.Add('    UPPERTITRESERIE VARCHAR(150),');
    Script.Add('    TOME INTEGER,');
    Script.Add('    ANNEEPARUTION INTEGER,');
    Script.Add('    MOISPARUTION INTEGER,');
    Script.Add('    ID_EDITEUR CHAR(38) CHARACTER SET NONE,');
    Script.Add('    NOMEDITEUR VARCHAR(50),');
    Script.Add('    ID_COLLECTION CHAR(38) CHARACTER SET NONE,');
    Script.Add('    NOMCOLLECTION VARCHAR(50))');
    Script.Add('AS');
    Script.Add('DECLARE VARIABLE MAXTOME2 INTEGER;');
    Script.Add('begin');
    Script.Add('  tome = maxtome + 1;');
    Script.Add('');
    Script.Add('  select max(tomefin) + 1 from albums');
    Script.Add('  where horsserie = 0 and integrale = 1 and id_serie = :in_idserie and (:withachat = 1 or achat = 0)');
    Script.Add('  into');
    Script.Add('    :MAXTOME2;');
    Script.Add('');
    Script.Add('  if (maxtome2 > tome) then tome = maxtome2;');
    Script.Add('');
    Script.Add('  select s.ID_SERIE, s.TitreSerie, s.UpperTitreSerie, e.ID_EDITEUR, e.NomEditeur, c.ID_COLLECTION, c.NomCollection from');
    Script.Add('    series s left join editeurs e on e.ID_EDITEUR = s.id_editeur');
    Script.Add('             left join collections c on c.ID_COLLECTION = s.id_collection');
    Script.Add('  where s.ID_SERIE = :in_idserie');
    Script.Add('  into');
    Script.Add('    :ID_SERIE,');
    Script.Add('    :TITRESERIE,');
    Script.Add('    :UPPERTITRESERIE,');
    Script.Add('    :ID_EDITEUR,');
    Script.Add('    :NOMEDITEUR,');
    Script.Add('    :ID_COLLECTION,');
    Script.Add('    :NOMCOLLECTION;');
    Script.Add('');
    Script.Add('  if (maxmois is null) then begin');
    Script.Add('    ANNEEPARUTION = maxannee + ((tome - maxtome) * ((sommeponderee / 12) / comptealbum));');
    Script.Add('    MOISPARUTION = null;');
    Script.Add('  end else begin');
    Script.Add('    MOISPARUTION = maxmois + ((tome - maxtome) * (sommeponderee / comptealbum));');
    Script.Add('    ANNEEPARUTION = maxannee;');
    Script.Add('    while (MOISPARUTION > 12) do begin');
    Script.Add('      MOISPARUTION = MOISPARUTION - 12;');
    Script.Add('      ANNEEPARUTION = ANNEEPARUTION + 1;');
    Script.Add('    end');
    Script.Add('  end');
    Script.Add('  suspend;');
    Script.Add('end;');

    Script.Add('ALTER PROCEDURE PREVISIONS_SORTIES (');
    Script.Add('    WITHACHAT SMALLINT,');
    Script.Add('    IN_ID_SERIE CHAR(38) CHARACTER SET NONE)');
    Script.Add('RETURNS (');
    Script.Add('    ID_SERIE CHAR(38) CHARACTER SET NONE,');
    Script.Add('    TITRESERIE VARCHAR(150),');
    Script.Add('    UPPERTITRESERIE VARCHAR(150),');
    Script.Add('    TOME INTEGER,');
    Script.Add('    ANNEEPARUTION INTEGER,');
    Script.Add('    MOISPARUTION INTEGER,');
    Script.Add('    ID_EDITEUR CHAR(38) CHARACTER SET NONE,');
    Script.Add('    NOMEDITEUR VARCHAR(50),');
    Script.Add('    ID_COLLECTION CHAR(38) CHARACTER SET NONE,');
    Script.Add('    NOMCOLLECTION VARCHAR(50))');
    Script.Add('AS');
    Script.Add('DECLARE VARIABLE CURRENTIDSERIE CHAR(38) CHARACTER SET NONE;');
    Script.Add('DECLARE VARIABLE OLDIDSERIE CHAR(38) CHARACTER SET NONE;');
    Script.Add('DECLARE VARIABLE CURRENTTOME INTEGER;');
    Script.Add('DECLARE VARIABLE SOMMEPONDEREE INTEGER;');
    Script.Add('DECLARE VARIABLE COMPTEALBUM INTEGER;');
    Script.Add('DECLARE VARIABLE CURRENTANNEE INTEGER;');
    Script.Add('DECLARE VARIABLE CURRENTMOIS INTEGER;');
    Script.Add('DECLARE VARIABLE TOMEPRECEDENT INTEGER;');
    Script.Add('DECLARE VARIABLE ANNEEPRECEDENTE INTEGER;');
    Script.Add('DECLARE VARIABLE MOISPRECEDENT INTEGER;');
    Script.Add('DECLARE VARIABLE DIFFMOIS INTEGER;');
    Script.Add('begin');
    Script.Add('  if (withachat is Null) then withachat = 1;');
    Script.Add('  oldidserie = NULL;');
    Script.Add('  tomeprecedent = -1;');
    Script.Add('  anneeprecedente = -1;');
    Script.Add('  moisprecedent = null;');
    Script.Add('  for select TOME, ANNEEPARUTION, MOISPARUTION, s.ID_SERIE');
    Script.Add('      from albums a inner join series s on s.ID_SERIE = a.id_serie');
    Script.Add('      where (s.terminee is null or s.terminee <> 1)');
    Script.Add('            and a.horsserie = 0 and a.integrale = 0 and a.anneeparution is not null');
    Script.Add('            and (:in_id_serie is null or s.ID_SERIE = :in_id_serie)');
    Script.Add('            and (:withachat = 1 or achat = 0)');
    Script.Add('      order by s.ID_SERIE, TOME');
    Script.Add('      into :CURRENTTOME, :CURRENTANNEE, :CURRENTMOIS, :currentidserie');
    Script.Add('  do begin');
    Script.Add('    if (oldidserie is null or currentidserie <> oldidserie) then begin');
    Script.Add('');
    Script.Add('      if (oldidserie IS NOT NULL and comptealbum > 0) then begin');
    Script.Add('        select ID_SERIE, TITRESERIE, UPPERTITRESERIE,');
    Script.Add('               TOME, ANNEEPARUTION, MOISPARUTION,');
    Script.Add('               ID_EDITEUR, NOMEDITEUR,');
    Script.Add('               ID_COLLECTION, NOMCOLLECTION');
    Script.Add('        from CALCUL_ANNEE_SORTIE(:withachat, :oldidserie, :sommeponderee, :comptealbum, :tomeprecedent, :anneeprecedente, :moisprecedent)');
    Script.Add('        into :ID_SERIE, :TITRESERIE, :UPPERTITRESERIE,');
    Script.Add('             :TOME, :ANNEEPARUTION, :MOISPARUTION,');
    Script.Add('             :ID_EDITEUR, :NOMEDITEUR,');
    Script.Add('             :ID_COLLECTION, :NOMCOLLECTION;');
    Script.Add('        suspend;');
    Script.Add('      end');
    Script.Add('');
    Script.Add('      oldidserie = currentidserie;');
    Script.Add('      sommeponderee = 0;');
    Script.Add('      comptealbum = 0;');
    Script.Add('      tomeprecedent = -1;');
    Script.Add('      anneeprecedente = -1;');
    Script.Add('      moisprecedent = -1;');
    Script.Add('    end');
    Script.Add('    if (tomeprecedent <> -1 and CURRENTTOME - TOMEPRECEDENT <> 0) then begin');
    Script.Add('      if (CURRENTMOIS is null or MOISPRECEDENT is null) then');
    Script.Add('        diffmois = 0;');
    Script.Add('      else');
    Script.Add('        diffmois = CURRENTMOIS - MOISPRECEDENT;');
    Script.Add('      /* non pondr: sommeponderee = sommeponderee + (((CURRENTANNEE - ANNEEPRECEDENTE) * 12 + (COALESCE(CURRENTMOIS, 1) - COALESCE(MOISPRECEDENT, 1))) / (CURRENTTOME - TOMEPRECEDENT)); */');
    Script.Add('      sommeponderee = sommeponderee + (((CURRENTANNEE - ANNEEPRECEDENTE) * 12 + diffmois) / (CURRENTTOME - TOMEPRECEDENT)) * CURRENTTOME;');
    Script.Add('      /* non pondr: comptealbum = comptealbum + 1;*/');
    Script.Add('      comptealbum = comptealbum + CURRENTTOME;');
    Script.Add('    end');
    Script.Add('    tomeprecedent = CURRENTTOME;');
    Script.Add('    anneeprecedente = CURRENTANNEE;');
    Script.Add('    moisprecedent = CURRENTMOIS;');
    Script.Add('  end');
    Script.Add('');
    Script.Add('  if (oldidserie IS NOT NULL and comptealbum > 0) then begin');
    Script.Add('    select ID_SERIE, TITRESERIE, UPPERTITRESERIE,');
    Script.Add('           TOME, ANNEEPARUTION, MOISPARUTION,');
    Script.Add('           ID_EDITEUR, NOMEDITEUR,');
    Script.Add('           ID_COLLECTION, NOMCOLLECTION');
    Script.Add('    from CALCUL_ANNEE_SORTIE(:withachat, :oldidserie, :sommeponderee, :comptealbum, :tomeprecedent, :anneeprecedente, :moisprecedent)');
    Script.Add('    into :ID_SERIE, :TITRESERIE, :UPPERTITRESERIE,');
    Script.Add('         :TOME, :ANNEEPARUTION, :MOISPARUTION,');
    Script.Add('         :ID_EDITEUR, :NOMEDITEUR,');
    Script.Add('         :ID_COLLECTION, :NOMCOLLECTION;');
    Script.Add('    suspend;');
    Script.Add('  end');
    Script.Add('end;');

    Script.Add('ALTER PROCEDURE LISTE_TOMES (');
    Script.Add('    WITHINTEGRALE SMALLINT,');
    Script.Add('    IN_IDSERIE CHAR(38) CHARACTER SET NONE)');
    Script.Add('RETURNS (');
    Script.Add('    ID_SERIE CHAR(38) CHARACTER SET NONE,');
    Script.Add('    TOME SMALLINT,');
    Script.Add('    INTEGRALE SMALLINT,');
    Script.Add('    ACHAT SMALLINT)');
    Script.Add('AS');
    Script.Add('DECLARE VARIABLE TOMEDEBUT INTEGER;');
    Script.Add('DECLARE VARIABLE TOMEFIN INTEGER;');
    Script.Add('begin');
    Script.Add('  for');
    Script.Add('    select id_serie, tome, integrale, achat');
    Script.Add('    from albums');
    Script.Add('    where TOME is not null and integrale = 0 and horsserie = 0');
    Script.Add('          and (:in_idserie is null or id_serie = :in_idserie)');
    Script.Add('    order by id_serie, tome');
    Script.Add('    into :id_serie, :TOME, :INTEGRALE, :ACHAT');
    Script.Add('    do');
    Script.Add('      suspend;');
    Script.Add('');
    Script.Add('  if (withintegrale is null) then withintegrale = 1;');
    Script.Add('  if (withintegrale = 1) then');
    Script.Add('    for');
    Script.Add('      select id_serie, tomedebut, tomefin, integrale, achat');
    Script.Add('      from albums');
    Script.Add('      where TOMEDEBUT is not null and TOMEFIN is not null and integrale = 1 and horsserie = 0');
    Script.Add('            and (:in_idserie is null or id_serie = :in_idserie)');
    Script.Add('      order by id_serie, tomedebut, tomefin');
    Script.Add('      into :ID_SERIE, :TOMEDEBUT, :TOMEFIN, :INTEGRALE, :ACHAT');
    Script.Add('      do begin');
    Script.Add('        TOME = TOMEDEBUT - 1;');
    Script.Add('        while (TOME <> TOMEFIN) do begin');
    Script.Add('          TOME = TOME + 1;');
    Script.Add('          suspend;');
    Script.Add('        end');
    Script.Add('      end');
    Script.Add('end;');

    Script.Add('ALTER PROCEDURE PROC_AUTEURS (');
    Script.Add('    ALBUM CHAR(38) CHARACTER SET NONE,');
    Script.Add('    SERIE CHAR(38) CHARACTER SET NONE,');
    Script.Add('    PARABD CHAR(38) CHARACTER SET NONE)');
    Script.Add('RETURNS (');
    Script.Add('    ID_PERSONNE CHAR(38) CHARACTER SET NONE,');
    Script.Add('    NOMPERSONNE VARCHAR(150),');
    Script.Add('    ID_ALBUM CHAR(38) CHARACTER SET NONE,');
    Script.Add('    ID_SERIE CHAR(38) CHARACTER SET NONE,');
    Script.Add('    ID_PARABD CHAR(38) CHARACTER SET NONE,');
    Script.Add('    METIER SMALLINT)');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  if (Album is not null) then');
    Script.Add('    for select p.ID_PERSONNE,');
    Script.Add('               p.nompersonne,');
    Script.Add('               a.id_album,');
    Script.Add('               NULL,');
    Script.Add('               NULL,');
    Script.Add('               a.metier');
    Script.Add('        from personnes p inner join auteurs a on a.id_personne = p.ID_PERSONNE');
    Script.Add('        where a.id_album = :ALBUM');
    Script.Add('        order by a.metier, p.uppernompersonne');
    Script.Add('        into :ID_PERSONNE,');
    Script.Add('             :NOMPERSONNE,');
    Script.Add('             :ID_ALBUM,');
    Script.Add('             :ID_SERIE,');
    Script.Add('             :ID_PARABD,');
    Script.Add('             :METIER');
    Script.Add('    do');
    Script.Add('      suspend;');
    Script.Add('');
    Script.Add('  if (Serie is not null) then');
    Script.Add('    for select p.ID_PERSONNE,');
    Script.Add('               p.nompersonne,');
    Script.Add('               NULL,');
    Script.Add('               a.id_serie,');
    Script.Add('               NULL,');
    Script.Add('               a.metier');
    Script.Add('        from personnes p inner join auteurs_series a on a.id_personne = p.ID_PERSONNE');
    Script.Add('        where a.id_serie = :SERIE');
    Script.Add('        order by a.metier, p.uppernompersonne');
    Script.Add('        into :ID_PERSONNE,');
    Script.Add('             :NOMPERSONNE,');
    Script.Add('             :ID_ALBUM,');
    Script.Add('             :ID_SERIE,');
    Script.Add('             :ID_PARABD,');
    Script.Add('             :METIER');
    Script.Add('    do');
    Script.Add('      suspend;');
    Script.Add('');
    Script.Add('  if (ParaBD is not null) then');
    Script.Add('    for select p.ID_PERSONNE,');
    Script.Add('               p.nompersonne,');
    Script.Add('               NULL,');
    Script.Add('               NULL,');
    Script.Add('               a.id_parabd,');
    Script.Add('               NULL');
    Script.Add('        from personnes p inner join auteurs_parabd a on a.id_personne = p.ID_PERSONNE');
    Script.Add('        where a.id_parabd = :PARABD');
    Script.Add('        order by p.uppernompersonne');
    Script.Add('        into :ID_PERSONNE,');
    Script.Add('             :NOMPERSONNE,');
    Script.Add('             :ID_ALBUM,');
    Script.Add('             :ID_SERIE,');
    Script.Add('             :ID_PARABD,');
    Script.Add('             :METIER');
    Script.Add('    do');
    Script.Add('      suspend;');
    Script.Add('end;');

    Script.Add('ALTER PROCEDURE ALBUMS_MANQUANTS (');
    Script.Add('    WITHINTEGRALE SMALLINT,');
    Script.Add('    WITHACHAT SMALLINT,');
    Script.Add('    IN_IDSERIE CHAR(38) CHARACTER SET NONE)');
    Script.Add('RETURNS (');
    Script.Add('    ID_SERIE CHAR(38) CHARACTER SET NONE,');
    Script.Add('    COUNTSERIE INTEGER,');
    Script.Add('    TITRESERIE VARCHAR(150),');
    Script.Add('    UPPERTITRESERIE VARCHAR(150),');
    Script.Add('    TOME INTEGER,');
    Script.Add('    ID_EDITEUR CHAR(38) CHARACTER SET NONE,');
    Script.Add('    NOMEDITEUR VARCHAR(50),');
    Script.Add('    ID_COLLECTION CHAR(38) CHARACTER SET NONE,');
    Script.Add('    NOMCOLLECTION VARCHAR(50))');
    Script.Add('AS');
    Script.Add('DECLARE VARIABLE MAXSERIE INTEGER;');
    Script.Add('DECLARE VARIABLE CURRENTTOME INTEGER;');
    Script.Add('DECLARE VARIABLE OWNEDTOME INTEGER;');
    Script.Add('DECLARE VARIABLE ACHAT SMALLINT;');
    Script.Add('DECLARE VARIABLE SUMACHAT INTEGER;');
    Script.Add('begin');
    Script.Add('  if (WITHINTEGRALE is null) then WITHINTEGRALE = 1;');
    Script.Add('  if (WITHACHAT is null) then WITHACHAT = 1;');
    Script.Add('  for select');
    Script.Add('        A.id_serie,');
    Script.Add('        max(TOME),');
    Script.Add('        count(distinct TOME),');
    Script.Add('        sum(ACHAT),');
    Script.Add('        S.id_editeur,');
    Script.Add('        NOMEDITEUR,');
    Script.Add('        S.id_collection,');
    Script.Add('        NOMCOLLECTION');
    Script.Add('      from liste_tomes(:WITHINTEGRALE, :in_idserie) A');
    Script.Add('         inner join SERIES S on A.ID_SERIE = S.ID_SERIE');
    Script.Add('         left join EDITEURS E on S.ID_EDITEUR = E.ID_EDITEUR');
    Script.Add('         left join COLLECTIONS C on S.id_collection = C.ID_COLLECTION');
    Script.Add('      where S.COMPLETE = 0');
    Script.Add('      group by A.id_serie, UPPERTITRESERIE, UPPERNOMEDITEUR, UPPERNOMCOLLECTION,');
    Script.Add('               S.id_editeur, NOMEDITEUR, S.id_collection, NOMCOLLECTION');
    Script.Add('      order by UPPERTITRESERIE, UPPERNOMEDITEUR, UPPERNOMCOLLECTION');
    Script.Add('      into');
    Script.Add('        :ID_SERIE,');
    Script.Add('        :MAXSERIE,');
    Script.Add('        :COUNTSERIE,');
    Script.Add('        :SUMACHAT,');
    Script.Add('        :ID_EDITEUR,');
    Script.Add('        :NOMEDITEUR,');
    Script.Add('        :ID_COLLECTION,');
    Script.Add('        :NOMCOLLECTION');
    Script.Add('  do begin');
    Script.Add('    if (WITHACHAT = 0) then');
    Script.Add('      COUNTSERIE = COUNTSERIE - SUMACHAT;');
    Script.Add('    if (COUNTSERIE <> MAXSERIE) then begin');
    Script.Add('      CURRENTTOME = 0;');
    Script.Add('      for select distinct');
    Script.Add('            UPPERTITRESERIE,');
    Script.Add('            TITRESERIE,');
    Script.Add('            TOME,');
    Script.Add('            ACHAT');
    Script.Add('          from liste_tomes(:WITHINTEGRALE, :ID_SERIE) A inner join SERIES S on A.ID_SERIE = S.ID_SERIE');
    Script.Add('          order by TOME');
    Script.Add('          into');
    Script.Add('            :UPPERTITRESERIE,');
    Script.Add('            :TITRESERIE,');
    Script.Add('            :OWNEDTOME,');
    Script.Add('            :ACHAT');
    Script.Add('      do begin');
    Script.Add('        CURRENTTOME = CURRENTTOME + 1;');
    Script.Add('        while ((CURRENTTOME <> OWNEDTOME) and (CURRENTTOME < MAXSERIE)) do begin');
    Script.Add('          TOME = CURRENTTOME;');
    Script.Add('          suspend;');
    Script.Add('          CURRENTTOME = CURRENTTOME + 1;');
    Script.Add('        end');
    Script.Add('        if ((WITHACHAT = 0) AND (ACHAT = 1)) then begin');
    Script.Add('          TOME = OWNEDTOME;');
    Script.Add('          suspend;');
    Script.Add('        end');
    Script.Add('      end');
    Script.Add('    end');
    Script.Add('  end');
    Script.Add('end;');

    Script.Add('ALTER PROCEDURE SERIES_BY_INITIALE (');
    Script.Add('    INITIALE CHAR(1))');
    Script.Add('RETURNS (');
    Script.Add('    ID_SERIE CHAR(38) CHARACTER SET NONE,');
    Script.Add('    TITRESERIE VARCHAR(150),');
    Script.Add('    ID_EDITEUR CHAR(38) CHARACTER SET NONE,');
    Script.Add('    NOMEDITEUR VARCHAR(50),');
    Script.Add('    ID_COLLECTION CHAR(38) CHARACTER SET NONE,');
    Script.Add('    NOMCOLLECTION VARCHAR(50))');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  FOR SELECT ID_SERIE,');
    Script.Add('             TITRESERIE,');
    Script.Add('             S.ID_EDITEUR,');
    Script.Add('             NOMEDITEUR,');
    Script.Add('             S.ID_COLLECTION,');
    Script.Add('             NOMCOLLECTION');
    Script.Add('      FROM SERIES S LEFT JOIN EDITEURS E ON S.id_editeur = E.ID_EDITEUR');
    Script.Add('                    LEFT JOIN COLLECTIONS C ON S.id_collection = C.ID_COLLECTION');
    Script.Add('      WHERE INITIALETITRESERIE = :INITIALE');
    Script.Add('      ORDER BY UPPERTITRESERIE, UPPERNOMEDITEUR, UPPERNOMCOLLECTION');
    Script.Add('      INTO :ID_SERIE,');
    Script.Add('           :TITRESERIE,');
    Script.Add('           :ID_EDITEUR,');
    Script.Add('           :NOMEDITEUR,');
    Script.Add('           :ID_COLLECTION,');
    Script.Add('           :NOMCOLLECTION');
    Script.Add('  DO');
    Script.Add('  BEGIN');
    Script.Add('    SUSPEND;');
    Script.Add('  END');
    Script.Add('end;');

    Script.Add('ALTER TRIGGER COLLECTIONS_EDITIONS_REF');
    Script.Add('ACTIVE AFTER UPDATE OR DELETE POSITION 0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  if (deleting) then update EDITIONS set ID_Collection = NULL where ID_Collection = old.ID_COLLECTION;');
    Script.Add('  if (updating) then update EDITIONS set ID_Collection = new.ID_COLLECTION, ID_Editeur = new.id_editeur where ID_Collection = old.ID_COLLECTION;');
    Script.Add('end;');

    Script.Add('ALTER TRIGGER COLLECTIONS_SERIE_REF');
    Script.Add('ACTIVE AFTER UPDATE OR DELETE POSITION 0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  if (deleting) then update SERIES set ID_Collection = NULL where ID_Collection = old.ID_COLLECTION;');
    Script.Add('  if (updating) then update SERIES set ID_Collection = new.ID_COLLECTION, ID_Editeur = new.id_editeur where ID_Collection = old.ID_COLLECTION;');
    Script.Add('end;');

    Script.Add('ALTER TRIGGER EDITIONS_COTE_BIU1');
    Script.Add('ACTIVE AFTER INSERT OR UPDATE POSITION 1');
    Script.Add('AS');
    Script.Add('declare variable existPRIX INTEGER;');
    Script.Add('begin');
    Script.Add('  if (new.anneecote is not null and new.prixcote is not null) then begin');
    Script.Add('    select COUNT(PRIXCOTE) from COTES where ID_EDITION = new.ID_EDITION AND ANNEECOTE = new.anneecote INTO :existPRIX;');
    Script.Add('    if (existPRIX = 0) then');
    Script.Add('      INSERT INTO COTES (ID_EDITION, ANNEECOTE, PRIXCOTE) VALUES (new.ID_EDITION, new.anneecote, new.prixcote);');
    Script.Add('    else');
    Script.Add('      UPDATE COTES SET PRIXCOTE = new.prixcote WHERE ID_EDITION = new.ID_EDITION AND ANNEECOTE = new.anneecote;');
    Script.Add('  end');
    Script.Add('end;');

    Script.Add('ALTER TRIGGER PARABD_COTE_BIU1');
    Script.Add('ACTIVE AFTER INSERT OR UPDATE POSITION 1');
    Script.Add('AS');
    Script.Add('declare variable existPRIX INTEGER;');
    Script.Add('begin');
    Script.Add('  if (new.anneecote is not null and new.prixcote is not null) then begin');
    Script.Add('    select COUNT(PRIXCOTE) from COTES_PARABD where ID_PARABD = new.id_parabd AND ANNEECOTE = new.anneecote INTO :existPRIX;');
    Script.Add('    if (existPRIX = 0) then');
    Script.Add('      INSERT INTO COTES_PARABD (ID_PARABD, ANNEECOTE, PRIXCOTE) VALUES (new.id_parabd, new.anneecote, new.prixcote);');
    Script.Add('    else');
    Script.Add('      UPDATE COTES_PARABD SET PRIXCOTE = new.prixcote WHERE ID_PARABD = new.id_parabd AND ANNEECOTE = new.anneecote;');
    Script.Add('  end');
    Script.Add('end;');

    Script.Add('ALTER TRIGGER EDITIONS_AD0');
    Script.Add('ACTIVE AFTER DELETE POSITION 0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  delete from couvertures where ID_album is null and ID_edition = old.ID_EDITION;');
    Script.Add('  update couvertures set ID_edition = null where ID_edition = old.ID_EDITION;');
    Script.Add('');
    Script.Add('  update albums set nbeditions = nbeditions - 1 where ID_ALBUM = old.id_album;');
    Script.Add('end;');

    Script.Add('ALTER TRIGGER EDITIONS_AU0');
    Script.Add('ACTIVE AFTER UPDATE POSITION 0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  if (new.ID_EDITION <> old.ID_EDITION) then begin');
    Script.Add('    update couvertures set ID_edition = new.ID_EDITION where ID_edition = old.ID_EDITION;');
    Script.Add('  end');
    Script.Add('');
    Script.Add('  if (new.id_album <> old.id_album) then begin');
    Script.Add('    update albums set nbeditions = nbeditions - 1 where ID_ALBUM = old.id_album;');
    Script.Add('    update albums set nbeditions = nbeditions + 1 where ID_ALBUM = new.id_album;');
    Script.Add('  end');
    Script.Add('end;');

    Script.Add('DROP VIEW VW_INITIALES_EDITEURS;');
    Script.Add('CREATE VIEW VW_INITIALES_EDITEURS(');
    Script.Add('    INITIALENOMEDITEUR,');
    Script.Add('    COUNTINITIALE)');
    Script.Add('AS');
    Script.Add('select');
    Script.Add('    initialenomediteur,');
    Script.Add('    Count(ID_EDITEUR)');
    Script.Add('from EDITEURS');
    Script.Add('group by initialenomediteur;');

    Script.Add('ALTER PROCEDURE EDITEURS_BY_INITIALE (');
    Script.Add('    INITIALE CHAR(1))');
    Script.Add('RETURNS (');
    Script.Add('    ID_EDITEUR CHAR(38) CHARACTER SET NONE,');
    Script.Add('    NOMEDITEUR VARCHAR(50))');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  FOR SELECT ID_EDITEUR,');
    Script.Add('             NOMEDITEUR');
    Script.Add('      FROM EDITEURS');
    Script.Add('      WHERE INITIALENOMEDITEUR = :INITIALE');
    Script.Add('      ORDER BY UPPERNOMEDITEUR');
    Script.Add('      INTO :ID_EDITEUR,');
    Script.Add('           :NOMEDITEUR');
    Script.Add('  DO');
    Script.Add('  BEGIN');
    Script.Add('    SUSPEND;');
    Script.Add('  END');
    Script.Add('end;');

    Script.Add('ALTER TRIGGER EDITEURS_SERIE_REF');
    Script.Add('ACTIVE AFTER UPDATE OR DELETE POSITION 0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  if (deleting) then update SERIES set ID_Editeur = NULL where ID_Editeur = old.ID_EDITEUR;');
    Script.Add('  if (updating) then update SERIES set ID_Editeur = new.ID_EDITEUR where ID_Editeur = old.ID_EDITEUR;');
    Script.Add('end;');

    Script.Add('ALTER TRIGGER EDITIONS_AI0');
    Script.Add('ACTIVE AFTER INSERT POSITION 0');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  update albums set nbeditions = nbeditions + 1 where ID_ALBUM = new.id_album;');
    Script.Add('end;');

    Script.Add('ALTER TRIGGER LISTES_AUD0');
    Script.Add('ACTIVE AFTER UPDATE OR DELETE POSITION 0');
    Script.Add('AS');
    Script.Add('DECLARE VARIABLE newvalue INTEGER;');
    Script.Add('begin');
    Script.Add('  if (deleting) then newvalue = null;');
    Script.Add('                else newvalue = new.REF;');
    Script.Add('');
    Script.Add('  if (old.categorie = 1) then update editions set etat = :newvalue where etat = old.ref;');
    Script.Add('  if (old.categorie = 2) then update editions set reliure = :newvalue where reliure = old.ref;');
    Script.Add('  if (old.categorie = 3) then update editions set typeedition = :newvalue where typeedition = old.ref;');
    Script.Add('  if (old.categorie = 4) then update editions set orientation = :newvalue where orientation = old.ref;');
    Script.Add('  if (old.categorie = 5) then update editions set FORMATEDITION = :newvalue where FORMATEDITION = old.ref;');
    Script.Add('  if (old.categorie = 6) then update couvertures set CATEGORIEIMAGE = :newvalue where CATEGORIEIMAGE = old.ref;');
    Script.Add('  if (old.categorie = 7) then update parabd set categorieparabd = :newvalue where categorieparabd = old.ref;');
    Script.Add('end;');

    Script.Add('ALTER PROCEDURE PROC_AJOUTMVT (');
    Script.Add('    ID_EDITION CHAR(38) CHARACTER SET NONE,');
    Script.Add('    ID_EMPRUNTEUR CHAR(38) CHARACTER SET NONE,');
    Script.Add('    DATEEMPRUNT TIMESTAMP,');
    Script.Add('    PRET SMALLINT)');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  insert into STATUT ( DateEmprunt,  ID_Emprunteur,  ID_Edition,  PretEmprunt)');
    Script.Add('              values (:DateEmprunt, :ID_Emprunteur, :ID_Edition, :Pret);');
    Script.Add('  update EDITIONS set Prete = :Pret where ID_EDITION = :ID_Edition;');
    Script.Add('end;');

    Script.Add('DROP VIEW VW_INITIALES_EMPRUNTEURS;');
    Script.Add('CREATE VIEW VW_INITIALES_EMPRUNTEURS(');
    Script.Add('    INITIALENOMEMPRUNTEUR,');
    Script.Add('    COUNTINITIALE)');
    Script.Add('AS');
    Script.Add('select');
    Script.Add('    initialenomemprunteur,');
    Script.Add('    Count(ID_EMPRUNTEUR)');
    Script.Add('from EMPRUNTEURS');
    Script.Add('group by initialenomemprunteur;');

    Script.Add('ALTER PROCEDURE EMPRUNTEURS_BY_INITIALE (');
    Script.Add('    INITIALE CHAR(1))');
    Script.Add('RETURNS (');
    Script.Add('    ID_EMPRUNTEUR CHAR(38) CHARACTER SET NONE,');
    Script.Add('    NOMEMPRUNTEUR VARCHAR(150))');
    Script.Add('AS');
    Script.Add('BEGIN');
    Script.Add('  FOR SELECT ID_EMPRUNTEUR,');
    Script.Add('             NOMEMPRUNTEUR');
    Script.Add('      FROM EMPRUNTEURS');
    Script.Add('      WHERE INITIALENOMEMPRUNTEUR = :INITIALE');
    Script.Add('      ORDER BY UPPERNOMEMPRUNTEUR');
    Script.Add('      INTO :ID_EMPRUNTEUR,');
    Script.Add('           :NOMEMPRUNTEUR');
    Script.Add('  DO');
    Script.Add('  BEGIN');
    Script.Add('    SUSPEND;');
    Script.Add('  END');
    Script.Add('END;');

    Script.Add('DROP VIEW VW_INITIALES_GENRES;');
    Script.Add('CREATE VIEW VW_INITIALES_GENRES(');
    Script.Add('    INITIALEGENRE,');
    Script.Add('    COUNTINITIALE)');
    Script.Add('AS');
    Script.Add('select');
    Script.Add('    initialeGENRE,');
    Script.Add('    Count(ID_GENRE)');
    Script.Add('from GENRES');
    Script.Add('group by initialeGENRE;');

    Script.Add('ALTER PROCEDURE GENRES_BY_INITIALE (');
    Script.Add('    INITIALE CHAR(1))');
    Script.Add('RETURNS (');
    Script.Add('    ID_GENRE CHAR(38) CHARACTER SET NONE,');
    Script.Add('    GENRE VARCHAR(30))');
    Script.Add('AS');
    Script.Add('begin');
    Script.Add('  FOR SELECT ID_GENRE,');
    Script.Add('             GENRE');
    Script.Add('      FROM GENRES');
    Script.Add('      WHERE INITIALEGENRE = :INITIALE');
    Script.Add('      ORDER BY UPPERGENRE');
    Script.Add('      INTO :ID_GENRE,');
    Script.Add('           :GENRE');
    Script.Add('  DO');
    Script.Add('  BEGIN');
    Script.Add('    SUSPEND;');
    Script.Add('  END');
    Script.Add('end;');

    Script.Add('DROP VIEW VW_LISTE_PARABD;');
    Script.Add('CREATE VIEW VW_LISTE_PARABD(');
    Script.Add('    ID_PARABD,');
    Script.Add('    TITREPARABD,');
    Script.Add('    ID_SERIE,');
    Script.Add('    TITRESERIE,');
    Script.Add('    UPPERTITREPARABD,');
    Script.Add('    UPPERTITRESERIE,');
    Script.Add('    ACHAT,');
    Script.Add('    COMPLET,');
    Script.Add('    SCATEGORIE)');
    Script.Add('AS');
    Script.Add('select a.ID_PARABD,');
    Script.Add('       a.TITREPARABD,');
    Script.Add('       a.ID_SERIE,');
    Script.Add('       s.TITRESERIE,');
    Script.Add('       a.UPPERTITREPARABD,');
    Script.Add('       s.UPPERTITRESERIE,');
    Script.Add('       a.ACHAT,');
    Script.Add('       a.COMPLET,');
    Script.Add('       lc.LIBELLE');
    Script.Add('FROM PARABD a INNER JOIN SERIES s ON s.ID_SERIE = a.id_serie');
    Script.Add('LEFT JOIN LISTES lc on (lc.ref = a.CATEGORIEPARABD and lc.categorie = 7);');

    Script.Add('DROP VIEW VW_INITIALES_PERSONNES;');
    Script.Add('CREATE VIEW VW_INITIALES_PERSONNES(');
    Script.Add('    INITIALENOMPERSONNE,');
    Script.Add('    COUNTINITIALE)');
    Script.Add('AS');
    Script.Add('select');
    Script.Add('    initialenomPERSONNE,');
    Script.Add('    Count(ID_PERSONNE)');
    Script.Add('from PERSONNES');
    Script.Add('group by initialenomPERSONNE;');

    Script.Add('ALTER PROCEDURE PERSONNES_BY_INITIALE (');
    Script.Add('    INITIALE CHAR(1))');
    Script.Add('RETURNS (');
    Script.Add('    ID_PERSONNE CHAR(38) CHARACTER SET NONE,');
    Script.Add('    NOMPERSONNE VARCHAR(150))');
    Script.Add('AS');
    Script.Add('BEGIN');
    Script.Add('  FOR SELECT ID_PERSONNE,');
    Script.Add('             NOMPERSONNE');
    Script.Add('      FROM PERSONNES');
    Script.Add('      WHERE INITIALENOMPERSONNE = :INITIALE');
    Script.Add('      ORDER BY UPPERNOMPERSONNE');
    Script.Add('      INTO :ID_PERSONNE,');
    Script.Add('           :NOMPERSONNE');
    Script.Add('  DO');
    Script.Add('  BEGIN');
    Script.Add('    SUSPEND;');
    Script.Add('  END');
    Script.Add('END;');

    Script.Add('DROP VIEW VW_INITIALES_SERIES;');
    Script.Add('CREATE VIEW VW_INITIALES_SERIES(');
    Script.Add('    INITIALETITRESERIE,');
    Script.Add('    COUNTINITIALE)');
    Script.Add('AS');
    Script.Add('select');
    Script.Add('    initialetitreserie,');
    Script.Add('    Count(ID_SERIE)');
    Script.Add('from SERIES');
    Script.Add('group by initialetitreserie;');

    Script.Add('ALTER PROCEDURE ALBUMS_BY_ANNEE (');
    Script.Add('    ANNEE INTEGER,');
    Script.Add('    FILTRE VARCHAR(125))');
    Script.Add('RETURNS (');
    Script.Add('    ID_ALBUM CHAR(38) CHARACTER SET NONE,');
    Script.Add('    TITREALBUM VARCHAR(150),');
    Script.Add('    TOME SMALLINT,');
    Script.Add('    TOMEDEBUT SMALLINT,');
    Script.Add('    TOMEFIN SMALLINT,');
    Script.Add('    HORSSERIE SMALLINT,');
    Script.Add('    INTEGRALE SMALLINT,');
    Script.Add('    MOISPARUTION SMALLINT,');
    Script.Add('    ANNEEPARUTION SMALLINT,');
    Script.Add('    ID_SERIE CHAR(38) CHARACTER SET NONE,');
    Script.Add('    TITRESERIE VARCHAR(150),');
    Script.Add('    ACHAT SMALLINT,');
    Script.Add('    COMPLET INTEGER)');
    Script.Add('AS');
    Script.Add('DECLARE VARIABLE SWHERE VARCHAR(200);');
    Script.Add('BEGIN');
    Script.Add('  if (:Annee = -1) then sWhere = ''ANNEEPARUTION is null '';');
    Script.Add('                   else sWhere = ''ANNEEPARUTION = '' || :ANNEE || '' '';');
    Script.Add('  if (filtre is not null and filtre <> '''') then swhere = swhere || ''and '' || filtre || '' '';');
    Script.Add('  for execute statement');
    Script.Add('      ''SELECT ID_ALBUM,');
    Script.Add('             TITREALBUM,');
    Script.Add('             TOME,');
    Script.Add('             TOMEDEBUT,');
    Script.Add('             TOMEFIN,');
    Script.Add('             HORSSERIE,');
    Script.Add('             INTEGRALE,');
    Script.Add('             MOISPARUTION,');
    Script.Add('             ANNEEPARUTION,');
    Script.Add('             ID_SERIE,');
    Script.Add('             TITRESERIE,');
    Script.Add('             ACHAT,');
    Script.Add('             COMPLET');
    Script.Add('        FROM vw_liste_albums');
    Script.Add('        WHERE '' || :sWHERE ||');
    Script.Add('        ''ORDER BY UPPERTITREALBUM, UPPERTITRESERIE, HORSSERIE NULLS FIRST, INTEGRALE NULLS FIRST, TOME NULLS FIRST, TOMEDEBUT NULLS FIRST, TOMEFIN NULLS FIRST, ANNEEPARUTION NULLS FIRST, MOISPARUTION NULLS FIRST''');
    Script.Add('        INTO :ID_ALBUM,');
    Script.Add('             :TITREALBUM,');
    Script.Add('             :TOME,');
    Script.Add('             :TOMEDEBUT,');
    Script.Add('             :TOMEFIN,');
    Script.Add('             :HORSSERIE,');
    Script.Add('             :INTEGRALE,');
    Script.Add('             :MOISPARUTION,');
    Script.Add('             :ANNEEPARUTION,');
    Script.Add('             :ID_SERIE,');
    Script.Add('             :TITRESERIE,');
    Script.Add('             :ACHAT,');
    Script.Add('             :COMPLET');
    Script.Add('      DO');
    Script.Add('      BEGIN');
    Script.Add('        SUSPEND;');
    Script.Add('      END');
    Script.Add('end;');

    Script.Add('ALTER PROCEDURE ALBUMS_BY_AUTEUR (');
    Script.Add('    ID_AUTEUR CHAR(38) CHARACTER SET NONE,');
    Script.Add('    FILTRE VARCHAR(125))');
    Script.Add('RETURNS (');
    Script.Add('    ID_ALBUM CHAR(38) CHARACTER SET NONE,');
    Script.Add('    TITREALBUM VARCHAR(150),');
    Script.Add('    TOME SMALLINT,');
    Script.Add('    TOMEDEBUT SMALLINT,');
    Script.Add('    TOMEFIN SMALLINT,');
    Script.Add('    HORSSERIE SMALLINT,');
    Script.Add('    INTEGRALE SMALLINT,');
    Script.Add('    MOISPARUTION SMALLINT,');
    Script.Add('    ANNEEPARUTION SMALLINT,');
    Script.Add('    ID_SERIE CHAR(38) CHARACTER SET NONE,');
    Script.Add('    TITRESERIE VARCHAR(150),');
    Script.Add('    METIER SMALLINT,');
    Script.Add('    ACHAT SMALLINT,');
    Script.Add('    COMPLET INTEGER)');
    Script.Add('AS');
    Script.Add('DECLARE VARIABLE SWHERE VARCHAR(200);');
    Script.Add('BEGIN');
    Script.Add('  swhere = '''';');
    Script.Add('  if (filtre is not null and filtre <> '''') then swhere = ''and '' || filtre || '' '';');
    Script.Add('  FOR execute statement');
    Script.Add('     ''SELECT A.ID_ALBUM,');
    Script.Add('             A.TITREALBUM,');
    Script.Add('             A.TOME,');
    Script.Add('             A.TOMEDEBUT,');
    Script.Add('             A.TOMEFIN,');
    Script.Add('             A.HORSSERIE,');
    Script.Add('             A.INTEGRALE,');
    Script.Add('             A.MOISPARUTION,');
    Script.Add('             A.ANNEEPARUTION,');
    Script.Add('             A.ID_SERIE,');
    Script.Add('             A.TITRESERIE,');
    Script.Add('             AU.metier,');
    Script.Add('             A.ACHAT,');
    Script.Add('             A.COMPLET');
    Script.Add('      FROM vw_liste_albums A INNER JOIN auteurs au on a.ID_album = au.ID_album');
    Script.Add('      WHERE au.ID_personne = '''''' || :id_auteur || '''''' '' || swhere ||');
    Script.Add('      ''ORDER BY UPPERTITRESERIE, HORSSERIE NULLS FIRST, INTEGRALE NULLS FIRST, TOME NULLS FIRST, ANNEEPARUTION NULLS FIRST, MOISPARUTION NULLS FIRST, UPPERTITREALBUM, METIER''');
    Script.Add('      INTO :ID_ALBUM,');
    Script.Add('           :TITREALBUM,');
    Script.Add('           :TOME,');
    Script.Add('           :TOMEDEBUT,');
    Script.Add('           :TOMEFIN,');
    Script.Add('           :HORSSERIE,');
    Script.Add('           :INTEGRALE,');
    Script.Add('           :MOISPARUTION,');
    Script.Add('           :ANNEEPARUTION,');
    Script.Add('           :ID_SERIE,');
    Script.Add('           :TITRESERIE,');
    Script.Add('           :METIER,');
    Script.Add('           :ACHAT,');
    Script.Add('           :COMPLET');
    Script.Add('      DO');
    Script.Add('      BEGIN');
    Script.Add('        SUSPEND;');
    Script.Add('      END');
    Script.Add('end;');

    Script.Add('ALTER PROCEDURE ALBUMS_BY_COLLECTION (');
    Script.Add('    ID_COLLECTION CHAR(38) CHARACTER SET NONE,');
    Script.Add('    FILTRE VARCHAR(125))');
    Script.Add('RETURNS (');
    Script.Add('    ID_ALBUM CHAR(38) CHARACTER SET NONE,');
    Script.Add('    TITREALBUM VARCHAR(150),');
    Script.Add('    TOME SMALLINT,');
    Script.Add('    TOMEDEBUT SMALLINT,');
    Script.Add('    TOMEFIN SMALLINT,');
    Script.Add('    HORSSERIE SMALLINT,');
    Script.Add('    INTEGRALE SMALLINT,');
    Script.Add('    MOISPARUTION SMALLINT,');
    Script.Add('    ANNEEPARUTION SMALLINT,');
    Script.Add('    ID_SERIE CHAR(38) CHARACTER SET NONE,');
    Script.Add('    TITRESERIE VARCHAR(150),');
    Script.Add('    ACHAT SMALLINT,');
    Script.Add('    COMPLET INTEGER)');
    Script.Add('AS');
    Script.Add('DECLARE VARIABLE SWHERE VARCHAR(200);');
    Script.Add('BEGIN');
    Script.Add('  if (:ID_COLLECTION = CAST('''' AS CHAR(38))) then sWhere = ''e.ID_COLLECTION is null '';');
    Script.Add('                           else sWhere = ''e.ID_COLLECTION = '''''' || :ID_COLLECTION || '''''' '';');
    Script.Add('  if (filtre is not null and filtre <> '''') then swhere = swhere || ''and '' || filtre || '' '';');
    Script.Add('  for execute statement');
    Script.Add('      ''SELECT a.ID_ALBUM,');
    Script.Add('             a.TITREALBUM,');
    Script.Add('             a.TOME,');
    Script.Add('             a.TOMEDEBUT,');
    Script.Add('             a.TOMEFIN,');
    Script.Add('             a.HORSSERIE,');
    Script.Add('             a.INTEGRALE,');
    Script.Add('             a.MOISPARUTION,');
    Script.Add('             a.ANNEEPARUTION,');
    Script.Add('             a.ID_SERIE,');
    Script.Add('             s.TITRESERIE,');
    Script.Add('             a.ACHAT,');
    Script.Add('             a.COMPLET');
    Script.Add('      from albums a left join editions e on a.ID_ALBUM = e.id_album');
    Script.Add('                    left join series s on a.id_serie = s.ID_SERIE');
    Script.Add('      WHERE '' || :sWHERE ||');
    Script.Add('     ''ORDER BY UPPERTITREALBUM, UPPERTITRESERIE, HORSSERIE NULLS FIRST, INTEGRALE NULLS FIRST, TOME NULLS FIRST, TOMEDEBUT NULLS FIRST, TOMEFIN NULLS FIRST, ANNEEPARUTION NULLS FIRST, MOISPARUTION NULLS FIRST''');
    Script.Add('      INTO :ID_ALBUM,');
    Script.Add('           :TITREALBUM,');
    Script.Add('           :TOME,');
    Script.Add('           :TOMEDEBUT,');
    Script.Add('           :TOMEFIN,');
    Script.Add('           :HORSSERIE,');
    Script.Add('           :INTEGRALE,');
    Script.Add('           :MOISPARUTION,');
    Script.Add('           :ANNEEPARUTION,');
    Script.Add('           :ID_SERIE,');
    Script.Add('           :TITRESERIE,');
    Script.Add('           :ACHAT,');
    Script.Add('           :COMPLET');
    Script.Add('      DO');
    Script.Add('      BEGIN');
    Script.Add('        SUSPEND;');
    Script.Add('      END');
    Script.Add('end;');

    Script.Add('ALTER PROCEDURE ALBUMS_BY_EDITEUR (');
    Script.Add('    ID_EDITEUR CHAR(38) CHARACTER SET NONE,');
    Script.Add('    FILTRE VARCHAR(125))');
    Script.Add('RETURNS (');
    Script.Add('    ID_ALBUM CHAR(38) CHARACTER SET NONE,');
    Script.Add('    TITREALBUM VARCHAR(150),');
    Script.Add('    TOME SMALLINT,');
    Script.Add('    TOMEDEBUT SMALLINT,');
    Script.Add('    TOMEFIN SMALLINT,');
    Script.Add('    HORSSERIE SMALLINT,');
    Script.Add('    INTEGRALE SMALLINT,');
    Script.Add('    MOISPARUTION SMALLINT,');
    Script.Add('    ANNEEPARUTION SMALLINT,');
    Script.Add('    ID_SERIE CHAR(38) CHARACTER SET NONE,');
    Script.Add('    TITRESERIE VARCHAR(150),');
    Script.Add('    ACHAT SMALLINT,');
    Script.Add('    COMPLET INTEGER)');
    Script.Add('AS');
    Script.Add('DECLARE VARIABLE SWHERE VARCHAR(133);');
    Script.Add('BEGIN');
    Script.Add('  swhere = '''';');
    Script.Add('  if (filtre is not null and filtre <> '''') then swhere = ''and '' || filtre || '' '';');
    Script.Add('  FOR execute statement');
    Script.Add('     ''SELECT a.ID_ALBUM,');
    Script.Add('             a.TITREALBUM,');
    Script.Add('             a.TOME,');
    Script.Add('             a.TOMEDEBUT,');
    Script.Add('             a.TOMEFIN,');
    Script.Add('             a.HORSSERIE,');
    Script.Add('             a.INTEGRALE,');
    Script.Add('             a.MOISPARUTION,');
    Script.Add('             a.ANNEEPARUTION,');
    Script.Add('             a.ID_SERIE,');
    Script.Add('             s.TITRESERIE,');
    Script.Add('             a.ACHAT,');
    Script.Add('             a.COMPLET');
    Script.Add('      from albums a LEFT join editions e on a.ID_ALBUM = e.id_album');
    Script.Add('                    LEFT join series s on a.id_serie = s.ID_SERIE');
    Script.Add('      WHERE coalesce(e.id_editeur, -1) = '''''' || :id_editeur || '''''' '' || swhere ||');
    Script.Add('      ''ORDER BY UPPERTITREALBUM, UPPERTITRESERIE, HORSSERIE NULLS FIRST, INTEGRALE NULLS FIRST, TOME NULLS FIRST, TOMEDEBUT NULLS FIRST, TOMEFIN NULLS FIRST, ANNEEPARUTION NULLS FIRST, MOISPARUTION NULLS FIRST''');
    Script.Add('      INTO :ID_ALBUM,');
    Script.Add('           :TITREALBUM,');
    Script.Add('           :TOME,');
    Script.Add('           :TOMEDEBUT,');
    Script.Add('           :TOMEFIN,');
    Script.Add('           :HORSSERIE,');
    Script.Add('           :INTEGRALE,');
    Script.Add('           :MOISPARUTION,');
    Script.Add('           :ANNEEPARUTION,');
    Script.Add('           :ID_SERIE,');
    Script.Add('           :TITRESERIE,');
    Script.Add('           :ACHAT,');
    Script.Add('           :COMPLET');
    Script.Add('  DO');
    Script.Add('  BEGIN');
    Script.Add('    SUSPEND;');
    Script.Add('  END');
    Script.Add('end;');

    Script.Add('ALTER PROCEDURE ALBUMS_BY_GENRE (');
    Script.Add('    ID_GENRE CHAR(38) CHARACTER SET NONE,');
    Script.Add('    FILTRE VARCHAR(125))');
    Script.Add('RETURNS (');
    Script.Add('    ID_ALBUM CHAR(38) CHARACTER SET NONE,');
    Script.Add('    TITREALBUM VARCHAR(150),');
    Script.Add('    TOME SMALLINT,');
    Script.Add('    TOMEDEBUT SMALLINT,');
    Script.Add('    TOMEFIN SMALLINT,');
    Script.Add('    HORSSERIE SMALLINT,');
    Script.Add('    INTEGRALE SMALLINT,');
    Script.Add('    MOISPARUTION SMALLINT,');
    Script.Add('    ANNEEPARUTION SMALLINT,');
    Script.Add('    ID_SERIE CHAR(38) CHARACTER SET NONE,');
    Script.Add('    TITRESERIE VARCHAR(150),');
    Script.Add('    ACHAT SMALLINT,');
    Script.Add('    COMPLET INTEGER)');
    Script.Add('AS');
    Script.Add('DECLARE VARIABLE SWHERE VARCHAR(200);');
    Script.Add('BEGIN');
    Script.Add('  if (:ID_Genre = CAST('''' AS CHAR(38))) then sWhere = ''ID_Genre is null '';');
    Script.Add('                      else sWhere = ''ID_genre = '''''' || :ID_genre || '''''' '';');
    Script.Add('  if (filtre is not null and filtre <> '''') then swhere = swhere || ''and '' || filtre || '' '';');
    Script.Add('  for execute statement');
    Script.Add('      ''SELECT ID_ALBUM,');
    Script.Add('             TITREALBUM,');
    Script.Add('             TOME,');
    Script.Add('             TOMEDEBUT,');
    Script.Add('             TOMEFIN,');
    Script.Add('             HORSSERIE,');
    Script.Add('             INTEGRALE,');
    Script.Add('             MOISPARUTION,');
    Script.Add('             ANNEEPARUTION,');
    Script.Add('             a.ID_SERIE,');
    Script.Add('             TITRESERIE,');
    Script.Add('             ACHAT,');
    Script.Add('             COMPLET');
    Script.Add('       FROM VW_LISTE_ALBUMS a LEFT JOIN GENRESERIES gs ON gs.id_serie = a.id_serie');
    Script.Add('                              LEFT JOIN GENRES g ON gs.id_genre = g.ID_GENRE');
    Script.Add('       WHERE '' || :sWHERE ||');
    Script.Add('      ''ORDER BY UPPERTITREALBUM, UPPERTITRESERIE, HORSSERIE NULLS FIRST, INTEGRALE NULLS FIRST, TOME NULLS FIRST, TOMEDEBUT NULLS FIRST, TOMEFIN NULLS FIRST, ANNEEPARUTION NULLS FIRST, MOISPARUTION NULLS FIRST''');
    Script.Add('       INTO :ID_ALBUM,');
    Script.Add('            :TITREALBUM,');
    Script.Add('            :TOME,');
    Script.Add('            :TOMEDEBUT,');
    Script.Add('            :TOMEFIN,');
    Script.Add('            :HORSSERIE,');
    Script.Add('            :INTEGRALE,');
    Script.Add('            :MOISPARUTION,');
    Script.Add('            :ANNEEPARUTION,');
    Script.Add('            :ID_SERIE,');
    Script.Add('            :TITRESERIE,');
    Script.Add('            :ACHAT,');
    Script.Add('            :COMPLET');
    Script.Add('      DO');
    Script.Add('      BEGIN');
    Script.Add('        SUSPEND;');
    Script.Add('      END');
    Script.Add('end;');

    Script.Add('ALTER PROCEDURE ALBUMS_BY_INITIALE (');
    Script.Add('    INITIALE CHAR(1),');
    Script.Add('    FILTRE VARCHAR(125))');
    Script.Add('RETURNS (');
    Script.Add('    ID_ALBUM CHAR(38) CHARACTER SET NONE,');
    Script.Add('    TITREALBUM VARCHAR(150),');
    Script.Add('    TOME SMALLINT,');
    Script.Add('    TOMEDEBUT SMALLINT,');
    Script.Add('    TOMEFIN SMALLINT,');
    Script.Add('    HORSSERIE SMALLINT,');
    Script.Add('    INTEGRALE SMALLINT,');
    Script.Add('    MOISPARUTION SMALLINT,');
    Script.Add('    ANNEEPARUTION SMALLINT,');
    Script.Add('    ID_SERIE CHAR(38) CHARACTER SET NONE,');
    Script.Add('    TITRESERIE VARCHAR(150),');
    Script.Add('    ACHAT SMALLINT,');
    Script.Add('    COMPLET INTEGER)');
    Script.Add('AS');
    Script.Add('DECLARE VARIABLE SWHERE VARCHAR(133);');
    Script.Add('BEGIN');
    Script.Add('  swhere = '''';');
    Script.Add('  if (filtre is not null and filtre <> '''') then swhere = ''and '' || filtre || '' '';');
    Script.Add('  FOR execute statement');
    Script.Add('     ''SELECT a.ID_ALBUM,');
    Script.Add('             a.TITREALBUM,');
    Script.Add('             a.TOME,');
    Script.Add('             a.TOMEDEBUT,');
    Script.Add('             a.TOMEFIN,');
    Script.Add('             a.HORSSERIE,');
    Script.Add('             a.INTEGRALE,');
    Script.Add('             a.MOISPARUTION,');
    Script.Add('             a.ANNEEPARUTION,');
    Script.Add('             a.ID_SERIE,');
    Script.Add('             s.TITRESERIE,');
    Script.Add('             a.ACHAT,');
    Script.Add('             a.COMPLET');
    Script.Add('      FROM ALBUMS a INNER JOIN SERIES s ON s.ID_SERIE = a.id_serie');
    Script.Add('      WHERE a.initialetitrealbum = '''''' || :INITIALE || '''''' '' || swhere ||');
    Script.Add('      ''ORDER BY UPPERTITREALBUM, UPPERTITRESERIE, HORSSERIE NULLS FIRST, INTEGRALE NULLS FIRST, TOME NULLS FIRST, TOMEDEBUT NULLS FIRST, TOMEFIN NULLS FIRST, ANNEEPARUTION NULLS FIRST, MOISPARUTION NULLS FIRST''');
    Script.Add('      INTO :ID_ALBUM,');
    Script.Add('           :TITREALBUM,');
    Script.Add('           :TOME,');
    Script.Add('           :TOMEDEBUT,');
    Script.Add('           :TOMEFIN,');
    Script.Add('           :HORSSERIE,');
    Script.Add('           :INTEGRALE,');
    Script.Add('           :MOISPARUTION,');
    Script.Add('           :ANNEEPARUTION,');
    Script.Add('           :ID_SERIE,');
    Script.Add('           :TITRESERIE,');
    Script.Add('           :ACHAT,');
    Script.Add('           :COMPLET');
    Script.Add('  DO');
    Script.Add('  BEGIN');
    Script.Add('    SUSPEND;');
    Script.Add('  END');
    Script.Add('end;');

    Script.Add('ALTER PROCEDURE ALBUMS_BY_SERIE (');
    Script.Add('    IN_ID_SERIE CHAR(38) CHARACTER SET NONE,');
    Script.Add('    FILTRE VARCHAR(125))');
    Script.Add('RETURNS (');
    Script.Add('    ID_ALBUM CHAR(38) CHARACTER SET NONE,');
    Script.Add('    TITREALBUM VARCHAR(150),');
    Script.Add('    TOME SMALLINT,');
    Script.Add('    TOMEDEBUT SMALLINT,');
    Script.Add('    TOMEFIN SMALLINT,');
    Script.Add('    HORSSERIE SMALLINT,');
    Script.Add('    INTEGRALE SMALLINT,');
    Script.Add('    MOISPARUTION SMALLINT,');
    Script.Add('    ANNEEPARUTION SMALLINT,');
    Script.Add('    ID_SERIE CHAR(38) CHARACTER SET NONE,');
    Script.Add('    TITRESERIE VARCHAR(150),');
    Script.Add('    ACHAT SMALLINT,');
    Script.Add('    COMPLET INTEGER)');
    Script.Add('AS');
    Script.Add('DECLARE VARIABLE SWHERE VARCHAR(130);');
    Script.Add('BEGIN');
    Script.Add('  swhere = '''';');
    Script.Add('  if (filtre is not null and filtre <> '''') then swhere = ''and '' || filtre || '' '';');
    Script.Add('  FOR execute statement');
    Script.Add('      ''SELECT ID_ALBUM,');
    Script.Add('             TITREALBUM,');
    Script.Add('             TOME,');
    Script.Add('             TOMEDEBUT,');
    Script.Add('             TOMEFIN,');
    Script.Add('             HORSSERIE,');
    Script.Add('             INTEGRALE,');
    Script.Add('             MOISPARUTION,');
    Script.Add('             ANNEEPARUTION,');
    Script.Add('             ID_SERIE,');
    Script.Add('             TITRESERIE,');
    Script.Add('             ACHAT,');
    Script.Add('             COMPLET');
    Script.Add('      FROM vw_liste_albums');
    Script.Add('      WHERE ID_serie = '''''' || :in_id_serie || '''''' '' || swhere ||');
    Script.Add('      ''ORDER BY HORSSERIE NULLS FIRST, INTEGRALE NULLS First, TOME NULLS FIRST, ANNEEPARUTION NULLS FIRST, MOISPARUTION NULLS FIRST, UPPERTITREALBUM''');
    Script.Add('      INTO :ID_ALBUM,');
    Script.Add('           :TITREALBUM,');
    Script.Add('           :TOME,');
    Script.Add('           :TOMEDEBUT,');
    Script.Add('           :TOMEFIN,');
    Script.Add('           :HORSSERIE,');
    Script.Add('           :INTEGRALE,');
    Script.Add('           :MOISPARUTION,');
    Script.Add('           :ANNEEPARUTION,');
    Script.Add('           :ID_SERIE,');
    Script.Add('           :TITRESERIE,');
    Script.Add('           :ACHAT,');
    Script.Add('           :COMPLET');
    Script.Add('  DO');
    Script.Add('  BEGIN');
    Script.Add('    SUSPEND;');
    Script.Add('  END');
    Script.Add('end;');

    Script.Add('ALTER PROCEDURE COLLECTIONS_ALBUMS (');
    Script.Add('    FILTRE VARCHAR(125))');
    Script.Add('RETURNS (');
    Script.Add('    NOMCOLLECTION VARCHAR(50),');
    Script.Add('    COUNTCOLLECTION INTEGER,');
    Script.Add('    ID_COLLECTION CHAR(38) CHARACTER SET NONE)');
    Script.Add('AS');
    Script.Add('DECLARE VARIABLE SWHERE VARCHAR(133);');
    Script.Add('begin');
    Script.Add('  swhere = '''';');
    Script.Add('  if (filtre is not null and filtre <> '''') then swhere = ''AND '' || filtre;');
    Script.Add('');
    Script.Add('  for execute statement');
    Script.Add('     ''select');
    Script.Add('             CAST(''''-1'''' AS VARCHAR(50)),');
    Script.Add('             Count(ID_ALBUM),');
    Script.Add('             NULL');
    Script.Add('      from vw_liste_collections_albums');
    Script.Add('      where ID_COLLECTION is null '' || SWHERE ||');
    Script.Add('     ''group by uppernomcollection, nomCOLLECTION, ID_COLLECTION''');
    Script.Add('  into :nomCOLLECTION,');
    Script.Add('       :countCOLLECTION,');
    Script.Add('       :ID_COLLECTION');
    Script.Add('  do begin');
    Script.Add('    suspend;');
    Script.Add('  end');
    Script.Add('');
    Script.Add('  for execute statement');
    Script.Add('     ''select');
    Script.Add('             nomCOLLECTION,');
    Script.Add('             Count(ID_ALBUM),');
    Script.Add('             ID_COLLECTION');
    Script.Add('      from vw_liste_collections_albums');
    Script.Add('      where ID_COLLECTION is not null '' || SWHERE ||');
    Script.Add('     ''group by uppernomcollection, nomCOLLECTION, ID_COLLECTION''');
    Script.Add('  into :nomCOLLECTION,');
    Script.Add('       :countCOLLECTION,');
    Script.Add('       :ID_COLLECTION');
    Script.Add('  do begin');
    Script.Add('    suspend;');
    Script.Add('  end');
    Script.Add('end;');

    Script.Add('ALTER PROCEDURE COLLECTIONS_BY_INITIALE (');
    Script.Add('    INITIALE CHAR(1),');
    Script.Add('    FILTRE VARCHAR(125))');
    Script.Add('RETURNS (');
    Script.Add('    ID_COLLECTION CHAR(38) CHARACTER SET NONE,');
    Script.Add('    NOMCOLLECTION VARCHAR(50))');
    Script.Add('AS');
    Script.Add('DECLARE VARIABLE SWHERE VARCHAR(133);');
    Script.Add('begin');
    Script.Add('  swhere = '''';');
    Script.Add('  if (filtre is not null and filtre <> '''') then swhere = ''and '' || filtre || '' '';');
    Script.Add('  FOR execute statement');
    Script.Add('     ''SELECT ID_COLLECTION,');
    Script.Add('             NOMCOLLECTION');
    Script.Add('      FROM COLLECTIONS');
    Script.Add('      WHERE INITIALENOMCOLLECTION = '''''' || :INITIALE || '''''' '' || swhere ||');
    Script.Add('      ''ORDER BY UPPERNOMCOLLECTION''');
    Script.Add('      INTO :ID_COLLECTION,');
    Script.Add('           :NOMCOLLECTION');
    Script.Add('  DO');
    Script.Add('  BEGIN');
    Script.Add('    SUSPEND;');
    Script.Add('  END');
    Script.Add('end;');

    Script.Add('ALTER PROCEDURE EDITEURS_ALBUMS (');
    Script.Add('    FILTRE VARCHAR(125))');
    Script.Add('RETURNS (');
    Script.Add('    NOMEDITEUR VARCHAR(50),');
    Script.Add('    COUNTEDITEUR INTEGER,');
    Script.Add('    ID_EDITEUR CHAR(38) CHARACTER SET NONE)');
    Script.Add('AS');
    Script.Add('DECLARE VARIABLE SWHERE VARCHAR(133);');
    Script.Add('begin');
    Script.Add('  swhere = '''';');
    Script.Add('  if (filtre is not null and filtre <> '''') then swhere = ''AND '' || filtre;');
    Script.Add('');
    Script.Add('  for execute statement');
    Script.Add('     ''select');
    Script.Add('             CAST(''''-1'''' AS VARCHAR(50)),');
    Script.Add('             Count(ID_ALBUM),');
    Script.Add('             NULL');
    Script.Add('      from vw_liste_editeurs_albums');
    Script.Add('      where ID_EDITEUR is null '' || SWHERE ||');
    Script.Add('     ''group by uppernomediteur, nomediteur, ID_editeur''');
    Script.Add('  into :nomediteur,');
    Script.Add('       :countediteur,');
    Script.Add('       :ID_Editeur');
    Script.Add('  do begin');
    Script.Add('    suspend;');
    Script.Add('  end');
    Script.Add('');
    Script.Add('  for execute statement');
    Script.Add('     ''select');
    Script.Add('             nomediteur,');
    Script.Add('             Count(ID_ALBUM),');
    Script.Add('             ID_Editeur');
    Script.Add('      from vw_liste_editeurs_albums');
    Script.Add('      where ID_EDITEUR is not null '' || SWHERE ||');
    Script.Add('     ''group by uppernomediteur, nomediteur, ID_editeur''');
    Script.Add('  into :nomediteur,');
    Script.Add('       :countediteur,');
    Script.Add('       :ID_Editeur');
    Script.Add('  do begin');
    Script.Add('    suspend;');
    Script.Add('  end');
    Script.Add('end;');

    Script.Add('ALTER PROCEDURE GENRES_ALBUMS (');
    Script.Add('    FILTRE VARCHAR(125))');
    Script.Add('RETURNS (');
    Script.Add('    GENRE VARCHAR(30),');
    Script.Add('    COUNTGENRE INTEGER,');
    Script.Add('    ID_GENRE CHAR(38) CHARACTER SET NONE)');
    Script.Add('AS');
    Script.Add('DECLARE VARIABLE SWHERE VARCHAR(132);');
    Script.Add('begin');
    Script.Add('  swhere = '''';');
    Script.Add('  if (filtre is not null and filtre <> '''') then swhere = ''AND '' || filtre;');
    Script.Add('');
    Script.Add('  for execute statement');
    Script.Add('     ''select');
    Script.Add('             CAST(''''-1'''' AS VARCHAR(30)),');
    Script.Add('             Count(ID_ALBUM),');
    Script.Add('             NULL');
    Script.Add('      from vw_liste_genres_albums');
    Script.Add('      where ID_GENRE is null '' || SWHERE ||');
    Script.Add('     ''group by uppergenre, Genre, ID_genre''');
    Script.Add('  into :genre,');
    Script.Add('       :countgenre,');
    Script.Add('       :ID_genre');
    Script.Add('  do begin');
    Script.Add('    suspend;');
    Script.Add('  end');
    Script.Add('');
    Script.Add('  for execute statement');
    Script.Add('     ''select');
    Script.Add('             Genre,');
    Script.Add('             Count(ID_ALBUM),');
    Script.Add('             ID_genre');
    Script.Add('      from vw_liste_genres_albums');
    Script.Add('      where ID_GENRE is not null '' || SWHERE ||');
    Script.Add('     ''group by uppergenre, Genre, ID_genre''');
    Script.Add('  into :genre,');
    Script.Add('       :countgenre,');
    Script.Add('       :ID_genre');
    Script.Add('  do begin');
    Script.Add('    suspend;');
    Script.Add('  end');
    Script.Add('end;');

    Script.Add('ALTER PROCEDURE INITIALES_ALBUMS (');
    Script.Add('    FILTRE VARCHAR(125))');
    Script.Add('RETURNS (');
    Script.Add('    INITIALETITREALBUM CHAR(1),');
    Script.Add('    COUNTINITIALE INTEGER)');
    Script.Add('AS');
    Script.Add('DECLARE VARIABLE SWHERE VARCHAR(133);');
    Script.Add('begin');
    Script.Add('  swhere = '''';');
    Script.Add('  if (filtre is not null and filtre <> '''') then swhere = ''WHERE '' || filtre;');
    Script.Add('  for execute statement');
    Script.Add('      ''select initialetitrealbum,');
    Script.Add('               Count(ID_ALBUM)');
    Script.Add('      from ALBUMS '' || SWHERE ||');
    Script.Add('      '' group by initialetitrealbum''');
    Script.Add('      into :INITIALETITREALBUM,');
    Script.Add('           :COUNTINITIALE');
    Script.Add('  do');
    Script.Add('    suspend;');
    Script.Add('end;');

    Script.Add('ALTER PROCEDURE INITIALES_COLLECTIONS (');
    Script.Add('    FILTRE VARCHAR(125))');
    Script.Add('RETURNS (');
    Script.Add('    INITIALENOMCOLLECTION CHAR(1),');
    Script.Add('    COUNTINITIALE INTEGER)');
    Script.Add('AS');
    Script.Add('DECLARE VARIABLE SWHERE VARCHAR(133);');
    Script.Add('begin');
    Script.Add('  swhere = '''';');
    Script.Add('  if (filtre is not null and filtre <> '''') then swhere = ''WHERE '' || filtre;');
    Script.Add('  for execute statement');
    Script.Add('      ''select initialenomCOLLECTION,');
    Script.Add('               Count(ID_COLLECTION)');
    Script.Add('      from COLLECTIONS '' || SWHERE ||');
    Script.Add('      '' group by initialenomCOLLECTION''');
    Script.Add('      into :INITIALENOMCOLLECTION,');
    Script.Add('           :COUNTINITIALE');
    Script.Add('  do');
    Script.Add('    suspend;');
    Script.Add('end;');

    Script.Add('ALTER PROCEDURE PARABD_BY_SERIE (');
    Script.Add('    IN_ID_SERIE CHAR(38) CHARACTER SET NONE,');
    Script.Add('    FILTRE VARCHAR(125))');
    Script.Add('RETURNS (');
    Script.Add('    ID_PARABD CHAR(38) CHARACTER SET NONE,');
    Script.Add('    TITREPARABD VARCHAR(150),');
    Script.Add('    ID_SERIE CHAR(38) CHARACTER SET NONE,');
    Script.Add('    TITRESERIE VARCHAR(150),');
    Script.Add('    ACHAT SMALLINT,');
    Script.Add('    COMPLET INTEGER,');
    Script.Add('    SCATEGORIE VARCHAR(50))');
    Script.Add('AS');
    Script.Add('DECLARE VARIABLE SWHERE VARCHAR(130);');
    Script.Add('BEGIN');
    Script.Add('  swhere = '''';');
    Script.Add('  if (filtre is not null and filtre <> '''') then swhere = ''and '' || filtre || '' '';');
    Script.Add('  FOR execute statement');
    Script.Add('      ''SELECT ID_PARABD,');
    Script.Add('             TITREPARABD,');
    Script.Add('             ID_PARABD,');
    Script.Add('             TITRESERIE,');
    Script.Add('             ACHAT,');
    Script.Add('             COMPLET,');
    Script.Add('             SCATEGORIE');
    Script.Add('      FROM vw_liste_PARABD');
    Script.Add('      WHERE ID_serie = '''''' || :in_id_serie || '''''' '' || swhere ||');
    Script.Add('      ''ORDER BY UPPERTITREPARABD''');
    Script.Add('      INTO :ID_PARABD,');
    Script.Add('           :TITREPARABD,');
    Script.Add('           :ID_SERIE,');
    Script.Add('           :TITRESERIE,');
    Script.Add('           :ACHAT,');
    Script.Add('           :COMPLET,');
    Script.Add('           :SCATEGORIE');
    Script.Add('  DO');
    Script.Add('  BEGIN');
    Script.Add('    SUSPEND;');
    Script.Add('  END');
    Script.Add('end;');

    Script.Add('ALTER PROCEDURE SERIES_ALBUMS (');
    Script.Add('    FILTRE VARCHAR(125))');
    Script.Add('RETURNS (');
    Script.Add('    TITRESERIE VARCHAR(150),');
    Script.Add('    COUNTSERIE INTEGER,');
    Script.Add('    ID_SERIE CHAR(38) CHARACTER SET NONE)');
    Script.Add('AS');
    Script.Add('DECLARE VARIABLE SWHERE VARCHAR(132);');
    Script.Add('begin');
    Script.Add('  swhere = '''';');
    Script.Add('  if (filtre is not null and filtre <> '''') then swhere = ''AND '' || filtre;');
    Script.Add('');
    Script.Add('  for execute statement');
    Script.Add('     ''select');
    Script.Add('             -1,');
    Script.Add('             ID_Serie,');
    Script.Add('             Count(ID_ALBUM)');
    Script.Add('      from vw_liste_albums');
    Script.Add('      where TITRESerie is null '' || SWHERE ||');
    Script.Add('    '' group by UPPERTITRESERIE, TITRESerie, ID_Serie''');
    Script.Add('  into :TITRESerie,');
    Script.Add('       :ID_Serie,');
    Script.Add('       :countSerie');
    Script.Add('  do');
    Script.Add('    suspend;');
    Script.Add('');
    Script.Add('  for execute statement');
    Script.Add('     ''select');
    Script.Add('             TITRESerie,');
    Script.Add('             ID_Serie,');
    Script.Add('             Count(ID_ALBUM)');
    Script.Add('      from vw_liste_albums');
    Script.Add('      where TITRESerie is not null '' || SWHERE ||');
    Script.Add('    '' group by UPPERTITRESERIE, TITRESerie, ID_Serie''');
    Script.Add('  into :TITRESerie,');
    Script.Add('       :ID_Serie,');
    Script.Add('       :countSerie');
    Script.Add('  do');
    Script.Add('    suspend;');
    Script.Add('end;');

    Script.Add('ALTER PROCEDURE SERIES_PARABD (');
    Script.Add('    FILTRE VARCHAR(125))');
    Script.Add('RETURNS (');
    Script.Add('    TITRESERIE VARCHAR(150),');
    Script.Add('    COUNTSERIE INTEGER,');
    Script.Add('    ID_SERIE CHAR(38) CHARACTER SET NONE)');
    Script.Add('AS');
    Script.Add('DECLARE VARIABLE SWHERE VARCHAR(132);');
    Script.Add('begin');
    Script.Add('  swhere = '''';');
    Script.Add('  if (filtre is not null and filtre <> '''') then swhere = ''AND '' || filtre;');
    Script.Add('');
    Script.Add('  for execute statement');
    Script.Add('     ''select');
    Script.Add('             -1,');
    Script.Add('             ID_Serie,');
    Script.Add('             Count(ID_PARABD)');
    Script.Add('      from vw_liste_parabd');
    Script.Add('      where TITRESerie is null '' || SWHERE ||');
    Script.Add('    '' group by UPPERTITRESERIE, TITRESerie, ID_Serie''');
    Script.Add('  into :TITRESerie,');
    Script.Add('       :ID_Serie,');
    Script.Add('       :countSerie');
    Script.Add('  do');
    Script.Add('    suspend;');
    Script.Add('');
    Script.Add('  for execute statement');
    Script.Add('     ''select');
    Script.Add('             TITRESerie,');
    Script.Add('             ID_Serie,');
    Script.Add('             Count(ID_PARABD)');
    Script.Add('      from vw_liste_parabd');
    Script.Add('      where TITRESerie is not null '' || SWHERE ||');
    Script.Add('    '' group by UPPERTITRESERIE, TITRESerie, ID_Serie''');
    Script.Add('  into :TITRESerie,');
    Script.Add('       :ID_Serie,');
    Script.Add('       :countSerie');
    Script.Add('  do');
    Script.Add('    suspend;');
    Script.Add('end;');

    Script.Add('ALTER PROCEDURE ANNEES_ALBUMS (');
    Script.Add('    FILTRE VARCHAR(125))');
    Script.Add('RETURNS (');
    Script.Add('    ANNEEPARUTION SMALLINT,');
    Script.Add('    COUNTANNEE INTEGER)');
    Script.Add('AS');
    Script.Add('DECLARE VARIABLE SWHERE VARCHAR(133);');
    Script.Add('begin');
    Script.Add('  swhere = '''';');
    Script.Add('  if (filtre is not null and filtre <> '''') then swhere = ''AND '' || filtre;');
    Script.Add('');
    Script.Add('  for execute statement');
    Script.Add('     ''select');
    Script.Add('             CAST(-1 AS SMALLINT),');
    Script.Add('             Count(ID_ALBUM)');
    Script.Add('      from vw_liste_albums');
    Script.Add('      where AnneeParution is null '' || SWHERE ||');
    Script.Add('     ''group by AnneeParution''');
    Script.Add('  into :AnneeParution,');
    Script.Add('       :countannee');
    Script.Add('  do begin');
    Script.Add('    suspend;');
    Script.Add('  end');
    Script.Add('');
    Script.Add('  for execute statement');
    Script.Add('     ''select');
    Script.Add('             AnneeParution,');
    Script.Add('             Count(ID_ALBUM)');
    Script.Add('      from vw_liste_albums');
    Script.Add('      where AnneeParution is not null '' || SWHERE ||');
    Script.Add('     ''group by AnneeParution''');
    Script.Add('  into :AnneeParution,');
    Script.Add('       :countannee');
    Script.Add('  do begin');
    Script.Add('    suspend;');
    Script.Add('  end');
    Script.Add('end;');

    Script.Add('DROP TRIGGER ALBUMS_AI;');
    Script.Add('DROP TRIGGER COLLECTIONS_AI;');
    Script.Add('DROP TRIGGER COUVERTURES_AI;');
    Script.Add('DROP TRIGGER EDITEURS_AI;');
    Script.Add('DROP TRIGGER EDITIONS_AI;');
    Script.Add('DROP TRIGGER EMPRUNTEURS_AI;');
    Script.Add('DROP TRIGGER GENRES_AI;');
    Script.Add('DROP TRIGGER PARABD_AI;');
    Script.Add('DROP TRIGGER PERSONNES_AI;');
    Script.Add('DROP TRIGGER SERIES_AI;');
    Script.Add('DROP TRIGGER STATUT_AI;');

    ExecuteScript;
  end;
end;

procedure MAJ1_2_0_0(Query: TJvUIBScript);
begin
  InitialiseTables(Query);
  RecreerVuesProcTrigger(Query);

  with Query do begin
    Script.Clear;

    Script.Add('DROP GENERATOR AI_REFALBUM;');
    Script.Add('DROP GENERATOR AI_REFCOLLECTION;');
    Script.Add('DROP GENERATOR AI_REFCOUVERTURE;');
    Script.Add('DROP GENERATOR AI_REFEDITEUR;');
    Script.Add('DROP GENERATOR AI_REFEDITION;');
    Script.Add('DROP GENERATOR AI_REFEMPRUNT;');
    Script.Add('DROP GENERATOR AI_REFEMPRUNTEUR;');
    Script.Add('DROP GENERATOR AI_REFGENRE;');
    Script.Add('DROP GENERATOR AI_REFPARABD;');
    Script.Add('DROP GENERATOR AI_REFPERSONNE;');
    Script.Add('DROP GENERATOR AI_REFSERIE;');
    Script.Add('ALTER TABLE ALBUMS DROP REFALBUM, DROP REFSERIE;');
    Script.Add('ALTER TABLE AUTEURS DROP REFALBUM, DROP REFPERSONNE;');
    Script.Add('ALTER TABLE AUTEURS_PARABD DROP REFPARABD, DROP REFPERSONNE;');
    Script.Add('ALTER TABLE AUTEURS_SERIES DROP REFSERIE, DROP REFPERSONNE;');
    Script.Add('ALTER TABLE COLLECTIONS DROP REFCOLLECTION, DROP REFEDITEUR;');
    Script.Add('ALTER TABLE COTES DROP REFEDITION;');
    Script.Add('ALTER TABLE COTES_PARABD DROP REFPARABD;');
    Script.Add('ALTER TABLE COUVERTURES DROP REFCOUVERTURE, DROP REFALBUM, DROP REFEDITION;');
    Script.Add('ALTER TABLE EDITEURS DROP REFEDITEUR;');
    Script.Add('ALTER TABLE EDITIONS DROP REFEDITION, DROP REFALBUM, DROP REFEDITEUR, DROP REFCOLLECTION;');
    Script.Add('ALTER TABLE EMPRUNTEURS DROP REFEMPRUNTEUR;');
    Script.Add('ALTER TABLE GENRES DROP REFGENRE;');
    Script.Add('ALTER TABLE GENRESERIES DROP REFSERIE, DROP REFGENRE;');
    Script.Add('ALTER TABLE PARABD DROP REFPARABD, DROP REFSERIE;');
    Script.Add('ALTER TABLE PERSONNES DROP REFPERSONNE;');
    Script.Add('ALTER TABLE SERIES DROP REFSERIE, DROP REFEDITEUR, DROP REFCOLLECTION;');
    Script.Add('ALTER TABLE STATUT DROP REFEMPRUNT, DROP REFEDITION, DROP REFEMPRUNTEUR;');

    ExecuteScript;
  end;
end;

initialization
  RegisterUpdate('1.2.0.0', @MAJ1_2_0_0);

end.

